<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Class ErrorHandlingFunctions
   </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Class ErrorHandlingFunctions
   ">
    <meta name="generator" content="docfx 2.39.2.0">
    
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions">
  
  
  <h1 id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions" data-uid="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions" class="text-break">Class ErrorHandlingFunctions
  </h1>
  <div class="markdown level0 summary"><p>Defines the native P/Invoke functions used with error handling.</p>
</div>
  <div class="markdown level0 conceptual"></div>
  <div class="inheritance">
    <h5>Inheritance</h5>
    <div class="level0"><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.object">Object</a></div>
    <div class="level1"><span class="xref">ErrorHandlingFunctions</span></div>
  </div>
  <div class="inheritedMembers">
    <h5>Inherited Members</h5>
    <div>
      <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.object.equals#System_Object_Equals_System_Object_">Object.Equals(Object)</a>
    </div>
    <div>
      <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.object.equals#System_Object_Equals_System_Object_System_Object_">Object.Equals(Object, Object)</a>
    </div>
    <div>
      <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.object.gethashcode#System_Object_GetHashCode">Object.GetHashCode()</a>
    </div>
    <div>
      <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.object.gettype#System_Object_GetType">Object.GetType()</a>
    </div>
    <div>
      <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.object.memberwiseclone#System_Object_MemberwiseClone">Object.MemberwiseClone()</a>
    </div>
    <div>
      <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.object.referenceequals#System_Object_ReferenceEquals_System_Object_System_Object_">Object.ReferenceEquals(Object, Object)</a>
    </div>
    <div>
      <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.object.tostring#System_Object_ToString">Object.ToString()</a>
    </div>
  </div>
  <h6><strong>Namespace</strong>: <a class="xref" href="THNETII.WinApi.Native.ErrorHandling.html">THNETII.WinApi.Native.ErrorHandling</a></h6>
  <h6><strong>Assembly</strong>: THNETII.WinApi.Functions.ErrorHandling.dll</h6>
  <h5 id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_syntax">Syntax</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static class ErrorHandlingFunctions</code></pre>
  </div>
  <h5 id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_remarks"><strong>Remarks</strong></h5>
  <div class="markdown level0 remarks"><p>See Microsoft Docs page: <a href="https://docs.microsoft.com/en-us/windows/desktop/debug/error-handling-functions">Error Handling Functions</a></p>
</div>
  <h3 id="methods">Methods
  </h3>
  
  
  <a id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_Beep_" data-uid="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.Beep*"></a>
  <h4 id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_Beep_System_Int32_System_Int32_" data-uid="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.Beep(System.Int32,System.Int32)">Beep(Int32, Int32)</h4>
  <div class="markdown level1 summary"><p>Generates simple tones on the speaker. The function is synchronous; it performs an alertable wait and does not return control to its caller until the sound finishes.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static bool Beep(int dwFreq, int dwDuration)</code></pre>
  </div>
  <h5 class="parameters">Parameters</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.int32">Int32</a></td>
        <td><span class="parametername">dwFreq</span></td>
        <td><p>The frequency of the sound, in hertz. This parameter must be in the range 37 through 32,767 (<code>0x25</code> through <code>0x7FFF</code>).</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.int32">Int32</a></td>
        <td><span class="parametername">dwDuration</span></td>
        <td><p>The duration of the sound, in milliseconds.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.boolean">Boolean</a></td>
        <td><p>If the function succeeds, the return value is <code>true</code>.</p>
<p>If the function fails, the return value is <code>false</code>. To get extended error information, call <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.runtime.interopservices.marshal.getlastwin32error#System_Runtime_InteropServices_Marshal_GetLastWin32Error">GetLastWin32Error()</a>.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_Beep_System_Int32_System_Int32__remarks">Remarks</h5>
  <div class="markdown level1 remarks"><p>
A long time ago, all PC computers shared a common 8254 programable interval timer chip for the generation of primitive sounds. The <a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_Beep_System_Int32_System_Int32_">Beep(Int32, Int32)</a> function was written specifically to emit a beep on that piece of hardware.
</p>
<p>
On these older systems, muting and volume controls have no effect on Beep; you would still hear the tone. To silence the tone, you used the following commands:
<pre><code>net stop beep
sc config beep start= disabled</code></pre>
</p>
<p>
Since then, sound cards have become standard equipment on almost all PC computers. As sound cards became more common, manufacturers began to remove the old timer chip from computers. The chips were also excluded from the design of server computers. The result is that <a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_Beep_System_Int32_System_Int32_">Beep(Int32, Int32)</a> did not work on all computers without the chip. This was okay because most developers had moved on to calling the <a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_MessageBeep_THNETII_WinApi_Native_WinUser_MB_ICON_">MessageBeep(MB_ICON)</a> function that uses whatever is the default sound device instead of the 8254 chip. 
</p>
<p>
Eventually because of the lack of hardware to communicate with, support for <a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_Beep_System_Int32_System_Int32_">Beep(Int32, Int32)</a> was dropped in Windows Vista and Windows XP 64-Bit Edition.
</p>
<p>
In Windows 7, <a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_Beep_System_Int32_System_Int32_">Beep(Int32, Int32)</a> was rewritten to pass the beep to the default sound device for the session. This is normally the sound card, except when run under Terminal Services, in which case the beep is rendered on the client.
</p>
<p>
<table><thead><tr><th>Requirements</th><th></th></tr></thead><tbody><tr><td><strong>Minimum supported client:</strong></td><td>Windows XP [desktop apps | UWP apps]</td></tr><tr><td><strong>Minimum supported server:</strong></td><td>Windows Server 2003 [desktop apps | UWP apps]</td></tr></tbody></table>
</p>
<p>Microsoft Docs page: <a href="https://msdn.microsoft.com/en-us/library/ms679277.aspx">Beep function</a></p>
</div>
  <h5 class="exceptions">Exceptions</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Condition</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.dllnotfoundexception">DllNotFoundException</a></td>
        <td><p>The native library containg the function could not be found.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.entrypointnotfoundexception">EntryPointNotFoundException</a></td>
        <td><p>Unable to find the entry point for the function in the native library.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_Beep_System_Int32_System_Int32__seealso">See Also</h5>
  <div class="seealso">
      <div><a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_MessageBeep_THNETII_WinApi_Native_WinUser_MB_ICON_">MessageBeep(MB_ICON)</a></div>
  </div>
  
  
  <a id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_CaptureStackBackTrace_" data-uid="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.CaptureStackBackTrace*"></a>
  <h4 id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_CaptureStackBackTrace_System_Int32_System_Int32_THNETII_InteropServices_NativeMemory_Specialized_ArrayOfIntPtr__System_Int32__" data-uid="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.CaptureStackBackTrace(System.Int32,System.Int32,THNETII.InteropServices.NativeMemory.Specialized.ArrayOfIntPtr@,System.Int32@)">CaptureStackBackTrace(Int32, Int32, out ArrayOfIntPtr, out Int32)</h4>
  <div class="markdown level1 summary"><p>Captures a stack back trace by walking up the stack and recording the information for each frame.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static ushort CaptureStackBackTrace(int FramesToSkip, int FramesToCapture, out ArrayOfIntPtr BackTrace, out int BackTraceHash)</code></pre>
  </div>
  <h5 class="parameters">Parameters</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.int32">Int32</a></td>
        <td><span class="parametername">FramesToSkip</span></td>
        <td><p>The number of frames to skip from the start of the back trace.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.int32">Int32</a></td>
        <td><span class="parametername">FramesToCapture</span></td>
        <td><p>The number of frames to be captured. You can capture up to the <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.uint16.maxvalue">MaxValue</a> of the <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.uint16">UInt16</a> type frames.</p>
<p><strong>Windows Server 2003 and Windows XP:</strong> The sum of the <code data-dev-comment-type="paramref" class="paramref">FramesToSkip</code> and <code data-dev-comment-type="paramref" class="paramref">FramesToCapture</code> parameters must be less than <code>63</code>.</p>
</td>
      </tr>
      <tr>
        <td><span class="xref">THNETII.InteropServices.NativeMemory.Specialized.ArrayOfIntPtr</span></td>
        <td><span class="parametername">BackTrace</span></td>
        <td><p>Receives a pointer to an array of stack frame pointers from the current stack trace.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.int32">Int32</a></td>
        <td><span class="parametername">BackTraceHash</span></td>
        <td><p>A value that can be used to organize hash tables. The value is optional and can be ignored or discarded.</p>
<p>This value is calculated based on the values of the pointers returned in the <code data-dev-comment-type="paramref" class="paramref">BackTrace</code> array. Two identical stack traces will generate identical hash values.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.uint16">UInt16</a></td>
        <td><p>The number of captured frames.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_CaptureStackBackTrace_System_Int32_System_Int32_THNETII_InteropServices_NativeMemory_Specialized_ArrayOfIntPtr__System_Int32___remarks">Remarks</h5>
  <div class="markdown level1 remarks"><p>
<table><thead><tr><th>Requirements</th><th></th></tr></thead><tbody><tr><td><strong>Minimum supported client:</strong></td><td>Windows XP [desktop apps | UWP apps]</td></tr><tr><td><strong>Minimum supported server:</strong></td><td>Windows Server 2003 [desktop apps | UWP apps]</td></tr></tbody></table>
</p>
<p>Microsoft Docs page: <a href="https://msdn.microsoft.com/en-us/library/Bb204633.aspx">CaptureStackBackTrace function</a></p>
</div>
  <h5 class="exceptions">Exceptions</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Condition</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.dllnotfoundexception">DllNotFoundException</a></td>
        <td><p>The native library containg the function could not be found.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.entrypointnotfoundexception">EntryPointNotFoundException</a></td>
        <td><p>Unable to find the entry point for the function in the native library.</p>
</td>
      </tr>
    </tbody>
  </table>
  
  
  <a id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FatalAppExit_" data-uid="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.FatalAppExit*"></a>
  <h4 id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FatalAppExit_System_Int32_System_String_" data-uid="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.FatalAppExit(System.Int32,System.String)">FatalAppExit(Int32, String)</h4>
  <div class="markdown level1 summary"><p>Displays a message box and terminates the application when the message box is closed. If the system is running with a debug version of Kernel32.dll, the message box gives the user the opportunity to terminate the application or to cancel the message box and return to the application that called <a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FatalAppExit_System_Int32_System_String_">FatalAppExit(Int32, String)</a>.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static void FatalAppExit(int uAction, string lpMessageText)</code></pre>
  </div>
  <h5 class="parameters">Parameters</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.int32">Int32</a></td>
        <td><span class="parametername">uAction</span></td>
        <td><p>This parameter must be <code>0</code> (zero).</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.string">String</a></td>
        <td><span class="parametername">lpMessageText</span></td>
        <td><p>The string that is displayed in the message box.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FatalAppExit_System_Int32_System_String__remarks">Remarks</h5>
  <div class="markdown level1 remarks"><p>An application calls <a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FatalAppExit_System_Int32_System_String_">FatalAppExit(Int32, String)</a> only when it is not capable of terminating any other way.</p>
<p>
<table><thead><tr><th>Requirements</th><th></th></tr></thead><tbody><tr><td><strong>Minimum supported client:</strong></td><td>Windows XP [desktop apps | UWP apps]</td></tr><tr><td><strong>Minimum supported server:</strong></td><td>Windows Server 2003 [desktop apps | UWP apps]</td></tr></tbody></table>
</p>
<p>Microsoft Docs page: <a href="https://msdn.microsoft.com/en-us/library/ms679336.aspx">FatalAppExit function</a></p>
</div>
  <h5 class="exceptions">Exceptions</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Condition</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.dllnotfoundexception">DllNotFoundException</a></td>
        <td><p>The native library containg the function could not be found.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.entrypointnotfoundexception">EntryPointNotFoundException</a></td>
        <td><p>Unable to find the entry point for the function in the native library.</p>
</td>
      </tr>
    </tbody>
  </table>
  
  
  <a id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FlashWindow_" data-uid="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.FlashWindow*"></a>
  <h4 id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FlashWindow_System_IntPtr_System_Boolean_" data-uid="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.FlashWindow(System.IntPtr,System.Boolean)">FlashWindow(IntPtr, Boolean)</h4>
  <div class="markdown level1 summary"><p>Flashes the specified window one time. It does not change the active state of the window.</p>
<p>To flash the window a specified number of times, use the <a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FlashWindowEx_THNETII_WinApi_Native_WinUser_FLASHWINFO__">FlashWindowEx(FLASHWINFO)</a> function.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static bool FlashWindow(IntPtr hWnd, bool bInvert)</code></pre>
  </div>
  <h5 class="parameters">Parameters</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.intptr">IntPtr</a></td>
        <td><span class="parametername">hWnd</span></td>
        <td><p>A handle to the window to be flashed. The window can be either open or minimized.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.boolean">Boolean</a></td>
        <td><span class="parametername">bInvert</span></td>
        <td><p>If this parameter is <code>true</code>, the window is flashed from one state to the other. If it is <code>false</code>, the window is returned to its original state (either active or inactive).</p>
<p>When an application is minimized and this parameter is <code>true</code>, the taskbar window button flashes active/inactive. If it is <code>false</code>, the taskbar window button flashes inactive, meaning that it does not change colors. It flashes, as if it were being redrawn, but it does not provide the visual invert clue to the user.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.boolean">Boolean</a></td>
        <td><p>The return value specifies the window's state before the call to the FlashWindow function. If the window caption was drawn as active before the call, the return value is <code>true</code>. Otherwise, the return value is <code>false</code>.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FlashWindow_System_IntPtr_System_Boolean__remarks">Remarks</h5>
  <div class="markdown level1 remarks"><p>Flashing a window means changing the appearance of its caption bar as if the window were changing from inactive to active status, or vice versa. (An inactive caption bar changes to an active caption bar; an active caption bar changes to an inactive caption bar.)</p>
<p>Typically, a window is flashed to inform the user that the window requires attention but that it does not currently have the keyboard focus.</p>
<p>The <a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FlashWindow_System_IntPtr_System_Boolean_">FlashWindow(IntPtr, Boolean)</a> function flashes the window only once; for repeated flashing, the application should create a system timer.</p>
<p>
<table><thead><tr><th>Requirements</th><th></th></tr></thead><tbody><tr><td><strong>Minimum supported client:</strong></td><td>Windows XP [desktop apps | UWP apps]</td></tr><tr><td><strong>Minimum supported server:</strong></td><td>Windows Server 2003 [desktop apps | UWP apps]</td></tr></tbody></table>
</p>
<p>Microsoft Docs page: <a href="https://docs.microsoft.com/en-us/windows/desktop/api/Winuser/nf-winuser-flashwindow">FlashWindow function</a></p>
</div>
  <h5 class="exceptions">Exceptions</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Condition</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.dllnotfoundexception">DllNotFoundException</a></td>
        <td><p>The native library containg the function could not be found.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.entrypointnotfoundexception">EntryPointNotFoundException</a></td>
        <td><p>Unable to find the entry point for the function in the native library.</p>
</td>
      </tr>
    </tbody>
  </table>
  
  
  <a id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FlashWindowEx_" data-uid="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.FlashWindowEx*"></a>
  <h4 id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FlashWindowEx_THNETII_WinApi_Native_WinUser_FLASHWINFO__" data-uid="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.FlashWindowEx(THNETII.WinApi.Native.WinUser.FLASHWINFO@)">FlashWindowEx(FLASHWINFO)</h4>
  <div class="markdown level1 summary"><p>Flashes the specified window. It does not change the active state of the window.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static bool FlashWindowEx(in FLASHWINFO pfwi)</code></pre>
  </div>
  <h5 class="parameters">Parameters</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="THNETII.WinApi.Native.WinUser.FLASHWINFO.html">FLASHWINFO</a></td>
        <td><span class="parametername">pfwi</span></td>
        <td><p>A <a class="xref" href="THNETII.WinApi.Native.WinUser.FLASHWINFO.html">FLASHWINFO</a> structure.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.boolean">Boolean</a></td>
        <td><p>The return value specifies the window's state before the call to the <a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FlashWindowEx_THNETII_WinApi_Native_WinUser_FLASHWINFO__">FlashWindowEx(FLASHWINFO)</a> function. If the window caption was drawn as active before the call, the return value is <code>true</code>. Otherwise, the return value is <code>false</code>.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FlashWindowEx_THNETII_WinApi_Native_WinUser_FLASHWINFO___remarks">Remarks</h5>
  <div class="markdown level1 remarks"><p>Typically, you flash a window to inform the user that the window requires attention but does not currently have the keyboard focus. When a window flashes, it appears to change from inactive to active status. An inactive caption bar changes to an active caption bar; an active caption bar changes to an inactive caption bar.</p>
<p>
<table><thead><tr><th>Requirements</th><th></th></tr></thead><tbody><tr><td><strong>Minimum supported client:</strong></td><td>Windows XP [desktop apps | UWP apps]</td></tr><tr><td><strong>Minimum supported server:</strong></td><td>Windows Server 2003 [desktop apps | UWP apps]</td></tr></tbody></table>
</p>
<p>Microsoft Docs page: <a href="https://docs.microsoft.com/en-us/windows/desktop/api/Winuser/nf-winuser-flashwindowex">FlashWindowEx function</a></p>
</div>
  <h5 class="exceptions">Exceptions</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Condition</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.dllnotfoundexception">DllNotFoundException</a></td>
        <td><p>The native library containg the function could not be found.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.entrypointnotfoundexception">EntryPointNotFoundException</a></td>
        <td><p>Unable to find the entry point for the function in the native library.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FlashWindowEx_THNETII_WinApi_Native_WinUser_FLASHWINFO___seealso">See Also</h5>
  <div class="seealso">
      <div><a class="xref" href="THNETII.WinApi.Native.WinUser.FLASHWINFO.html">FLASHWINFO</a></div>
  </div>
  
  
  <a id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FormatMessage_" data-uid="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.FormatMessage*"></a>
  <h4 id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FormatMessage_THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_OPTIONS_System_IntPtr_System_Int32_System_Int32_System_Text_StringBuilder_System_Int32_System_IntPtr_" data-uid="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.FormatMessage(THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_OPTIONS,System.IntPtr,System.Int32,System.Int32,System.Text.StringBuilder,System.Int32,System.IntPtr)">FormatMessage(FORMAT_MESSAGE_OPTIONS, IntPtr, Int32, Int32, StringBuilder, Int32, IntPtr)</h4>
  <div class="markdown level1 summary"><p>Formats a message string. The function requires a message definition as input.
It can come from a message table resource in an already-loaded module.
Or the caller can ask the function to search the system's message table resource(s) for the message definition.
The function finds the message definition in a message table resource based on a message identifier and a language identifier.
The function copies the formatted message text to an output buffer, processing any embedded insert sequences if requested.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static int FormatMessage(FORMAT_MESSAGE_OPTIONS dwFlags, IntPtr lpSource, int dwMessageId, int dwLanguageId, StringBuilder lpBuffer, int nSize, IntPtr Arguments)</code></pre>
  </div>
  <h5 class="parameters">Parameters</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_OPTIONS.html">FORMAT_MESSAGE_OPTIONS</a></td>
        <td><span class="parametername">dwFlags</span></td>
        <td><p>
The formatting options, and how to interpret the <code data-dev-comment-type="paramref" class="paramref">lpSource</code> parameter.
The <a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_OPTIONS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_OPTIONS_Width">Width</a> property specifies how the function handles line breaks in the output buffer. It can also specify the maximum width of a formatted output line.
</p>
<p>
The function ignores regular line breaks in the message definition text. The function never splits a string delimited by white space across a line break. The function stores hard-coded line breaks in the message definition text into the output buffer. Hard-coded line breaks are coded with the <code>%n</code> escape sequence.
</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.intptr">IntPtr</a></td>
        <td><span class="parametername">lpSource</span></td>
        <td><p>The location of the message definition. The type of this parameter depends upon the settings in the <code data-dev-comment-type="paramref" class="paramref">dwFlags</code> parameter.</p>
<table><thead><tr><th><code><code data-dev-comment-type="paramref" class="paramref">dwFlags</code></code></th><th>Meaning</th></tr></thead><tbody><tr><td><code><a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_FLAGS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_FLAGS_FORMAT_MESSAGE_FROM_HMODULE">FORMAT_MESSAGE_FROM_HMODULE</a></code></td><td>A handle to the module that contains the message table to search.</td></tr><tr><td><code><a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_FLAGS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_FLAGS_FORMAT_MESSAGE_FROM_STRING">FORMAT_MESSAGE_FROM_STRING</a></code></td><td>Pointer to a string that consists of unformatted message text. It will be scanned for inserts and formatted accordingly.</td></tr></tbody></table>
If neither of these flags is set in <code data-dev-comment-type="paramref" class="paramref">dwFlags</code>, then <code data-dev-comment-type="paramref" class="paramref">lpSource</code> is ignored.
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.int32">Int32</a></td>
        <td><span class="parametername">dwMessageId</span></td>
        <td><p>The message identifier for the requested message. This parameter is ignored if<code data-dev-comment-type="paramref" class="paramref">dwFlags</code> includes <a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_FLAGS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_FLAGS_FORMAT_MESSAGE_FROM_STRING">FORMAT_MESSAGE_FROM_STRING</a>.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.int32">Int32</a></td>
        <td><span class="parametername">dwLanguageId</span></td>
        <td><p>The language identifier for the requested message. This parameter is ignored if <code data-dev-comment-type="paramref" class="paramref">dwFlags</code> includes <a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_FLAGS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_FLAGS_FORMAT_MESSAGE_FROM_STRING">FORMAT_MESSAGE_FROM_STRING</a>.</p>
<p>
If you pass a specific LCID in this parameter, <a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FormatMessage_THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_OPTIONS_System_IntPtr_System_Int32_System_Int32_System_Text_StringBuilder_System_Int32_System_IntPtr_">FormatMessage(FORMAT_MESSAGE_OPTIONS, IntPtr, Int32, Int32, StringBuilder, Int32, IntPtr)</a> will return a message for that LCID only.
If the function cannot find a message for that LCID, it sets Last-Error to <a class="xref" href="THNETII.WinApi.Native.WinError.WinErrorConstants.html#THNETII_WinApi_Native_WinError_WinErrorConstants_ERROR_RESOURCE_LANG_NOT_FOUND">ERROR_RESOURCE_LANG_NOT_FOUND</a>.
If you pass in <code>0</code> (zero), <a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FormatMessage_THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_OPTIONS_System_IntPtr_System_Int32_System_Int32_System_Text_StringBuilder_System_Int32_System_IntPtr_">FormatMessage(FORMAT_MESSAGE_OPTIONS, IntPtr, Int32, Int32, StringBuilder, Int32, IntPtr)</a> looks for a message for LCIDs in the following order:
<ol><li>Language neutral</li><li>Thread LCID, based on the thread&apos;s locale value</li><li>User default LCID, based on the user&apos;s default locale value</li><li>System default LCID, based on the system default locale value</li><li>US English</li></ol>
</p>
<p>
If <a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FormatMessage_THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_OPTIONS_System_IntPtr_System_Int32_System_Int32_System_Text_StringBuilder_System_Int32_System_IntPtr_">FormatMessage(FORMAT_MESSAGE_OPTIONS, IntPtr, Int32, Int32, StringBuilder, Int32, IntPtr)</a> does not locate a message for any of the preceding LCIDs,
it returns any language message string that is present. If that fails, it returns <a class="xref" href="THNETII.WinApi.Native.WinError.WinErrorConstants.html#THNETII_WinApi_Native_WinError_WinErrorConstants_ERROR_RESOURCE_LANG_NOT_FOUND">ERROR_RESOURCE_LANG_NOT_FOUND</a>. 
</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.text.stringbuilder">StringBuilder</a></td>
        <td><span class="parametername">lpBuffer</span></td>
        <td><p>A buffer that receives the the string that specifies the formatted message.</p>
<p><strong>DO NOT</strong> use this overload with the <a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_FLAGS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_FLAGS_FORMAT_MESSAGE_ALLOCATE_BUFFER">FORMAT_MESSAGE_ALLOCATE_BUFFER</a> flag set in <code data-dev-comment-type="paramref" class="paramref">dwFlags</code>!</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.int32">Int32</a></td>
        <td><span class="parametername">nSize</span></td>
        <td><p>Specifies the <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.text.stringbuilder.capacity#System_Text_StringBuilder_Capacity">Capacity</a> of <code data-dev-comment-type="paramref" class="paramref">lpBuffer</code>.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.intptr">IntPtr</a></td>
        <td><span class="parametername">Arguments</span></td>
        <td><p>A pointer to an array of values that are used as insert values in the formatted message. A <code>%1</code> in the format string indicates the first value in the Arguments array; a <code>%2</code> indicates the second argument; and so on.</p>
<p>The interpretation of each value depends on the formatting information associated with the insert in the message definition. The default is to treat each value as a pointer to a null-terminated unicode string.</p>
<p><strong>DO NOT</strong> use this parameter if the <a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_FLAGS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_FLAGS_FORMAT_MESSAGE_ARGUMENT_ARRAY">FORMAT_MESSAGE_ARGUMENT_ARRAY</a> flag is not set in <code data-dev-comment-type="paramref" class="paramref">dwFlags</code>!</p>
<p>The default value of <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.intptr.zero">Zero</a> can be used to indicate no insert arguments. This should be used when the <a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_FLAGS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_FLAGS_FORMAT_MESSAGE_IGNORE_INSERTS">FORMAT_MESSAGE_IGNORE_INSERTS</a> flag is set in <code data-dev-comment-type="paramref" class="paramref">dwFlags</code></p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.int32">Int32</a></td>
        <td><p>
If the function succeeds, the return value is the number of characters stored in the output buffer, excluding the terminating null character.
</p>
<p>If the function fails, the return value is <code>0</code> (zero). To get extended error information, call <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.runtime.interopservices.marshal.getlastwin32error#System_Runtime_InteropServices_Marshal_GetLastWin32Error">GetLastWin32Error()</a>.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FormatMessage_THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_OPTIONS_System_IntPtr_System_Int32_System_Int32_System_Text_StringBuilder_System_Int32_System_IntPtr__remarks">Remarks</h5>
  <div class="markdown level1 remarks"><p>
Within the message text, several escape sequences are supported for dynamically formatting the message. These escape sequences and their meanings are shown in the following tables. All escape sequences start with the percent character (%).
<table><thead><tr><th>Escape sequence</th><th>Meaning</th></tr></thead><tbody><tr><td><code>%0</code></td><td>Terminates a message text line without a trailing new line character. This escape sequence can be used to build up long lines or to terminate the message itself without a trailing new line character. It is useful for prompt messages.</td></tr><tr><td><code>%n!<em>format string</em>!</code></td><td>
<p>Identifies an insert. The value of <em>n</em> can be in the range from 1 through 99. The format string (which must be surrounded by exclamation marks) is optional and defaults to <code>!s!</code> if not specified. For more information, see <a href="http://go.microsoft.com/fwlink/p/?linkid=83949">Format Specification Fields</a>.</p>
<p>The format string can include a width and precision specifier for strings and a width specifier for integers. Use an asterisk (<code>*</code>) to specify the width and precision. For example, <code>%1!.*s!</code> or <code>%1!*u!</code>.</p>
<p>If you do not use the width and precision specifiers, the insert numbers correspond directly to the input arguments. For example, if the source string is <code>&quot;%1 %2 %1&quot;</code> and the input arguments are <code>&quot;Bill&quot;</code> and <code>&quot;Bob&quot;</code>, the formatted output string is <code>&quot;Bill Bob Bill&quot;</code>.</p>
<p>However, if you use a width and precision specifier, the insert numbers do not correspond directly to the input arguments. For example, the insert numbers for the previous example could change to <code>&quot;%1!*.*s! %4 %5!*s!&quot;</code>.</p>
<p>The next insert number is <code>n + 2</code> if the previous format string contained one asterisk and is <code>n + 3</code> if two asterisks were specified.</p>
<p>If you want to repeat <code>&quot;Bill&quot;</code>, as in the previous example, the arguments must include <code>&quot;Bill&quot;</code> twice. For example, if the source string is <code>&quot;%1!*.*s! %4 %5!*s!&quot;</code>, the arguments could be, <code>4</code>, <code>2</code>, <code>&quot;Bill&quot;</code>, <code>&quot;Bob&quot;</code>, <code>6</code>, <code>&quot;Bill&quot;</code> (if using the <a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_FLAGS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_FLAGS_FORMAT_MESSAGE_ARGUMENT_ARRAY">FORMAT_MESSAGE_ARGUMENT_ARRAY</a> flag). The formatted string would then be <code>&quot;  Bi Bob   Bill&quot;</code>.</p>
<p>Repeating insert numbers when the source string contains width and precision specifiers may not yield the intended results. If you replaced <code>%5</code> with <code>%1</code>, the function would try to print a string at address 6 (likely resulting in an access violation).</p>
<p>Floating-point format specifiers—<code>e</code>, <code>E</code>, <code>f</code>, and <code>g</code>—are not supported. The workaround is to pre-format floating-point number using the regular <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.double.tostring#System_Double_ToString">ToString()</a> method and then insert that string.</p>
<p>Inserts that use the <code>I64</code> prefix are treated as two 32-bit arguments.</p>
</td></tr></tbody></table>
</p>
<p>
Any other nondigit character following a percent character is formatted in the output message without the percent character. Following are some examples.
<table><thead><tr><th>Format string</th><th>Resulting output</th></tr></thead><tbody><tr><td><code>%%</code></td><td>A single percent sign.</td></tr><tr><td><code>%<em>space</em></code></td><td>A single space. This format string can be used to ensure the appropriate number of trailing spaces in a message text line.</td></tr><tr><td><code>%.</code></td><td>A single period. This format string can be used to include a single period at the beginning of a line without terminating the message text definition.</td></tr><tr><td><code>%!</code></td><td>A single exclamation point. This format string can be used to include an exclamation point immediately after an insert without its being mistaken for the beginning of a format string.</td></tr><tr><td><code>%n</code></td><td>A hard line break when the format string occurs at the end of a line. This format string is useful when <a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FormatMessage_THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_OPTIONS_System_IntPtr_System_Int32_System_Int32_System_Text_StringBuilder_System_Int32_System_IntPtr_">FormatMessage(FORMAT_MESSAGE_OPTIONS, IntPtr, Int32, Int32, StringBuilder, Int32, IntPtr)</a> is supplying regular line breaks so the message fits in a certain width.</td></tr><tr><td><code>%r</code></td><td>A hard carriage return without a trailing newline character.</td></tr><tr><td><code>%t</code></td><td>A single tab.</td></tr></tbody></table>
</p>
<p>
<strong>Security Remarks</strong><br>
If this function is called without <a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_FLAGS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_FLAGS_FORMAT_MESSAGE_IGNORE_INSERTS">FORMAT_MESSAGE_IGNORE_INSERTS</a>, the <code data-dev-comment-type="paramref" class="paramref">Arguments</code> parameter must contain enough parameters to satisfy all insertion sequences in the message string, and they must be of the correct type. Therefore, do not use untrusted or unknown message strings with inserts enabled because they can contain more insertion sequences than <code data-dev-comment-type="paramref" class="paramref">Arguments</code> provides, or those that may be of the wrong type. In particular, it is unsafe to take an arbitrary system error code returned from an API and use <a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_FLAGS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_FLAGS_FORMAT_MESSAGE_FROM_SYSTEM">FORMAT_MESSAGE_FROM_SYSTEM</a> without <a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_FLAGS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_FLAGS_FORMAT_MESSAGE_IGNORE_INSERTS">FORMAT_MESSAGE_IGNORE_INSERTS</a>. 
</p>
<p>
<table><thead><tr><th>Requirements</th><th></th></tr></thead><tbody><tr><td><strong>Minimum supported client:</strong></td><td>Windows XP [desktop apps | UWP apps]</td></tr><tr><td><strong>Minimum supported server:</strong></td><td>Windows Server 2003 [desktop apps | UWP apps]</td></tr></tbody></table>
</p>
<p>Microsoft Docs page: <a href="https://docs.microsoft.com/en-us/windows/desktop/api/Winuser/nf-winuser-formatmessagew">FormatMessageW function</a></p>
</div>
  <h5 class="exceptions">Exceptions</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Condition</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.dllnotfoundexception">DllNotFoundException</a></td>
        <td><p>The native library containg the function could not be found.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.entrypointnotfoundexception">EntryPointNotFoundException</a></td>
        <td><p>Unable to find the entry point for the function in the native library.</p>
</td>
      </tr>
    </tbody>
  </table>
  
  
  <a id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FormatMessage_" data-uid="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.FormatMessage*"></a>
  <h4 id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FormatMessage_THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_OPTIONS_System_IntPtr_System_Int32_System_Int32_THNETII_InteropServices_NativeMemory_Specialized_WideStringPtr__System_Int32_System_IntPtr_" data-uid="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.FormatMessage(THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_OPTIONS,System.IntPtr,System.Int32,System.Int32,THNETII.InteropServices.NativeMemory.Specialized.WideStringPtr@,System.Int32,System.IntPtr)">FormatMessage(FORMAT_MESSAGE_OPTIONS, IntPtr, Int32, Int32, out WideStringPtr, Int32, IntPtr)</h4>
  <div class="markdown level1 summary"><p>Formats a message string. The function requires a message definition as input.
It can come from a message table resource in an already-loaded module.
Or the caller can ask the function to search the system's message table resource(s) for the message definition.
The function finds the message definition in a message table resource based on a message identifier and a language identifier.
The function copies the formatted message text to an output buffer, processing any embedded insert sequences if requested.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static int FormatMessage(FORMAT_MESSAGE_OPTIONS dwFlags, IntPtr lpSource, int dwMessageId, int dwLanguageId, out WideStringPtr lpBuffer, int nSize, IntPtr Arguments)</code></pre>
  </div>
  <h5 class="parameters">Parameters</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_OPTIONS.html">FORMAT_MESSAGE_OPTIONS</a></td>
        <td><span class="parametername">dwFlags</span></td>
        <td><p>
The formatting options, and how to interpret the <code data-dev-comment-type="paramref" class="paramref">lpSource</code> parameter.
The <a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_OPTIONS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_OPTIONS_Width">Width</a> property specifies how the function handles line breaks in the output buffer. It can also specify the maximum width of a formatted output line.
</p>
<p>
The function ignores regular line breaks in the message definition text. The function never splits a string delimited by white space across a line break. The function stores hard-coded line breaks in the message definition text into the output buffer. Hard-coded line breaks are coded with the <code>%n</code> escape sequence.
</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.intptr">IntPtr</a></td>
        <td><span class="parametername">lpSource</span></td>
        <td><p>The location of the message definition. The type of this parameter depends upon the settings in the <code data-dev-comment-type="paramref" class="paramref">dwFlags</code> parameter.</p>
<table><thead><tr><th><code><code data-dev-comment-type="paramref" class="paramref">dwFlags</code></code></th><th>Meaning</th></tr></thead><tbody><tr><td><code><a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_FLAGS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_FLAGS_FORMAT_MESSAGE_FROM_HMODULE">FORMAT_MESSAGE_FROM_HMODULE</a></code></td><td>A handle to the module that contains the message table to search.</td></tr><tr><td><code><a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_FLAGS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_FLAGS_FORMAT_MESSAGE_FROM_STRING">FORMAT_MESSAGE_FROM_STRING</a></code></td><td>Pointer to a string that consists of unformatted message text. It will be scanned for inserts and formatted accordingly.</td></tr></tbody></table>
If neither of these flags is set in <code data-dev-comment-type="paramref" class="paramref">dwFlags</code>, then <code data-dev-comment-type="paramref" class="paramref">lpSource</code> is ignored.
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.int32">Int32</a></td>
        <td><span class="parametername">dwMessageId</span></td>
        <td><p>The message identifier for the requested message. This parameter is ignored if<code data-dev-comment-type="paramref" class="paramref">dwFlags</code> includes <a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_FLAGS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_FLAGS_FORMAT_MESSAGE_FROM_STRING">FORMAT_MESSAGE_FROM_STRING</a>.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.int32">Int32</a></td>
        <td><span class="parametername">dwLanguageId</span></td>
        <td><p>The language identifier for the requested message. This parameter is ignored if <code data-dev-comment-type="paramref" class="paramref">dwFlags</code> includes <a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_FLAGS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_FLAGS_FORMAT_MESSAGE_FROM_STRING">FORMAT_MESSAGE_FROM_STRING</a>.</p>
<p>
If you pass a specific LCID in this parameter, <a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FormatMessage_THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_OPTIONS_System_IntPtr_System_Int32_System_Int32_THNETII_InteropServices_NativeMemory_Specialized_WideStringPtr__System_Int32_System_IntPtr_">FormatMessage(FORMAT_MESSAGE_OPTIONS, IntPtr, Int32, Int32, out WideStringPtr, Int32, IntPtr)</a> will return a message for that LCID only.
If the function cannot find a message for that LCID, it sets Last-Error to <a class="xref" href="THNETII.WinApi.Native.WinError.WinErrorConstants.html#THNETII_WinApi_Native_WinError_WinErrorConstants_ERROR_RESOURCE_LANG_NOT_FOUND">ERROR_RESOURCE_LANG_NOT_FOUND</a>.
If you pass in <code>0</code> (zero), <a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FormatMessage_THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_OPTIONS_System_IntPtr_System_Int32_System_Int32_THNETII_InteropServices_NativeMemory_Specialized_WideStringPtr__System_Int32_System_IntPtr_">FormatMessage(FORMAT_MESSAGE_OPTIONS, IntPtr, Int32, Int32, out WideStringPtr, Int32, IntPtr)</a> looks for a message for LCIDs in the following order:
<ol><li>Language neutral</li><li>Thread LCID, based on the thread&apos;s locale value</li><li>User default LCID, based on the user&apos;s default locale value</li><li>System default LCID, based on the system default locale value</li><li>US English</li></ol>
</p>
<p>
If <a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FormatMessage_THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_OPTIONS_System_IntPtr_System_Int32_System_Int32_THNETII_InteropServices_NativeMemory_Specialized_WideStringPtr__System_Int32_System_IntPtr_">FormatMessage(FORMAT_MESSAGE_OPTIONS, IntPtr, Int32, Int32, out WideStringPtr, Int32, IntPtr)</a> does not locate a message for any of the preceding LCIDs,
it returns any language message string that is present. If that fails, it returns <a class="xref" href="THNETII.WinApi.Native.WinError.WinErrorConstants.html#THNETII_WinApi_Native_WinError_WinErrorConstants_ERROR_RESOURCE_LANG_NOT_FOUND">ERROR_RESOURCE_LANG_NOT_FOUND</a>. 
</p>
</td>
      </tr>
      <tr>
        <td><span class="xref">THNETII.InteropServices.NativeMemory.Specialized.WideStringPtr</span></td>
        <td><span class="parametername">lpBuffer</span></td>
        <td><p>Receives a buffer to the null-terminated string that specifies the formatted message. <strong>ONLY</strong> use this overload if <a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_FLAGS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_FLAGS_FORMAT_MESSAGE_ALLOCATE_BUFFER">FORMAT_MESSAGE_ALLOCATE_BUFFER</a> is included in <code data-dev-comment-type="paramref" class="paramref">dwFlags</code>.</p>
<p>The function allocates a buffer using the <see cref="!:LocalAlloc"></see> function.</p>
<p>This buffer cannot be larger than 64K bytes.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.int32">Int32</a></td>
        <td><span class="parametername">nSize</span></td>
        <td><p>Specifies the minimum number of characters to allocate for the output buffer to return in <code data-dev-comment-type="paramref" class="paramref">lpBuffer</code>.</p>
<p>The output buffer cannot be larger than 64K bytes.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.intptr">IntPtr</a></td>
        <td><span class="parametername">Arguments</span></td>
        <td><p>A pointer to an array of values that are used as insert values in the formatted message. A <code>%1</code> in the format string indicates the first value in the Arguments array; a <code>%2</code> indicates the second argument; and so on.</p>
<p>The interpretation of each value depends on the formatting information associated with the insert in the message definition. The default is to treat each value as a pointer to a null-terminated unicode string.</p>
<p><strong>DO NOT</strong> use this parameter if the <a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_FLAGS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_FLAGS_FORMAT_MESSAGE_ARGUMENT_ARRAY">FORMAT_MESSAGE_ARGUMENT_ARRAY</a> flag is not set in <code data-dev-comment-type="paramref" class="paramref">dwFlags</code>!</p>
<p>The default value of <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.intptr.zero">Zero</a> can be used to indicate no insert arguments. This should be used when the <a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_FLAGS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_FLAGS_FORMAT_MESSAGE_IGNORE_INSERTS">FORMAT_MESSAGE_IGNORE_INSERTS</a> flag is set in <code data-dev-comment-type="paramref" class="paramref">dwFlags</code></p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.int32">Int32</a></td>
        <td><p>
If the function succeeds, the return value is the number of characters stored in the output buffer, excluding the terminating null character.
</p>
<p>If the function fails, the return value is <code>0</code> (zero). To get extended error information, call <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.runtime.interopservices.marshal.getlastwin32error#System_Runtime_InteropServices_Marshal_GetLastWin32Error">GetLastWin32Error()</a>.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FormatMessage_THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_OPTIONS_System_IntPtr_System_Int32_System_Int32_THNETII_InteropServices_NativeMemory_Specialized_WideStringPtr__System_Int32_System_IntPtr__remarks">Remarks</h5>
  <div class="markdown level1 remarks"><p>
Within the message text, several escape sequences are supported for dynamically formatting the message. These escape sequences and their meanings are shown in the following tables. All escape sequences start with the percent character (%).
<table><thead><tr><th>Escape sequence</th><th>Meaning</th></tr></thead><tbody><tr><td><code>%0</code></td><td>Terminates a message text line without a trailing new line character. This escape sequence can be used to build up long lines or to terminate the message itself without a trailing new line character. It is useful for prompt messages.</td></tr><tr><td><code>%n!<em>format string</em>!</code></td><td>
<p>Identifies an insert. The value of <em>n</em> can be in the range from 1 through 99. The format string (which must be surrounded by exclamation marks) is optional and defaults to <code>!s!</code> if not specified. For more information, see <a href="http://go.microsoft.com/fwlink/p/?linkid=83949">Format Specification Fields</a>.</p>
<p>The format string can include a width and precision specifier for strings and a width specifier for integers. Use an asterisk (<code>*</code>) to specify the width and precision. For example, <code>%1!.*s!</code> or <code>%1!*u!</code>.</p>
<p>If you do not use the width and precision specifiers, the insert numbers correspond directly to the input arguments. For example, if the source string is <code>&quot;%1 %2 %1&quot;</code> and the input arguments are <code>&quot;Bill&quot;</code> and <code>&quot;Bob&quot;</code>, the formatted output string is <code>&quot;Bill Bob Bill&quot;</code>.</p>
<p>However, if you use a width and precision specifier, the insert numbers do not correspond directly to the input arguments. For example, the insert numbers for the previous example could change to <code>&quot;%1!*.*s! %4 %5!*s!&quot;</code>.</p>
<p>The next insert number is <code>n + 2</code> if the previous format string contained one asterisk and is <code>n + 3</code> if two asterisks were specified.</p>
<p>If you want to repeat <code>&quot;Bill&quot;</code>, as in the previous example, the arguments must include <code>&quot;Bill&quot;</code> twice. For example, if the source string is <code>&quot;%1!*.*s! %4 %5!*s!&quot;</code>, the arguments could be, <code>4</code>, <code>2</code>, <code>&quot;Bill&quot;</code>, <code>&quot;Bob&quot;</code>, <code>6</code>, <code>&quot;Bill&quot;</code> (if using the <a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_FLAGS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_FLAGS_FORMAT_MESSAGE_ARGUMENT_ARRAY">FORMAT_MESSAGE_ARGUMENT_ARRAY</a> flag). The formatted string would then be <code>&quot;  Bi Bob   Bill&quot;</code>.</p>
<p>Repeating insert numbers when the source string contains width and precision specifiers may not yield the intended results. If you replaced <code>%5</code> with <code>%1</code>, the function would try to print a string at address 6 (likely resulting in an access violation).</p>
<p>Floating-point format specifiers—<code>e</code>, <code>E</code>, <code>f</code>, and <code>g</code>—are not supported. The workaround is to pre-format floating-point number using the regular <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.double.tostring#System_Double_ToString">ToString()</a> method and then insert that string.</p>
<p>Inserts that use the <code>I64</code> prefix are treated as two 32-bit arguments.</p>
</td></tr></tbody></table>
</p>
<p>
Any other nondigit character following a percent character is formatted in the output message without the percent character. Following are some examples.
<table><thead><tr><th>Format string</th><th>Resulting output</th></tr></thead><tbody><tr><td><code>%%</code></td><td>A single percent sign.</td></tr><tr><td><code>%<em>space</em></code></td><td>A single space. This format string can be used to ensure the appropriate number of trailing spaces in a message text line.</td></tr><tr><td><code>%.</code></td><td>A single period. This format string can be used to include a single period at the beginning of a line without terminating the message text definition.</td></tr><tr><td><code>%!</code></td><td>A single exclamation point. This format string can be used to include an exclamation point immediately after an insert without its being mistaken for the beginning of a format string.</td></tr><tr><td><code>%n</code></td><td>A hard line break when the format string occurs at the end of a line. This format string is useful when <a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FormatMessage_THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_OPTIONS_System_IntPtr_System_Int32_System_Int32_THNETII_InteropServices_NativeMemory_Specialized_WideStringPtr__System_Int32_System_IntPtr_">FormatMessage(FORMAT_MESSAGE_OPTIONS, IntPtr, Int32, Int32, out WideStringPtr, Int32, IntPtr)</a> is supplying regular line breaks so the message fits in a certain width.</td></tr><tr><td><code>%r</code></td><td>A hard carriage return without a trailing newline character.</td></tr><tr><td><code>%t</code></td><td>A single tab.</td></tr></tbody></table>
</p>
<p>
<strong>Security Remarks</strong><br>
If this function is called without <a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_FLAGS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_FLAGS_FORMAT_MESSAGE_IGNORE_INSERTS">FORMAT_MESSAGE_IGNORE_INSERTS</a>, the <code data-dev-comment-type="paramref" class="paramref">Arguments</code> parameter must contain enough parameters to satisfy all insertion sequences in the message string, and they must be of the correct type. Therefore, do not use untrusted or unknown message strings with inserts enabled because they can contain more insertion sequences than <code data-dev-comment-type="paramref" class="paramref">Arguments</code> provides, or those that may be of the wrong type. In particular, it is unsafe to take an arbitrary system error code returned from an API and use <a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_FLAGS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_FLAGS_FORMAT_MESSAGE_FROM_SYSTEM">FORMAT_MESSAGE_FROM_SYSTEM</a> without <a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_FLAGS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_FLAGS_FORMAT_MESSAGE_IGNORE_INSERTS">FORMAT_MESSAGE_IGNORE_INSERTS</a>. 
</p>
<p>
<table><thead><tr><th>Requirements</th><th></th></tr></thead><tbody><tr><td><strong>Minimum supported client:</strong></td><td>Windows XP [desktop apps | UWP apps]</td></tr><tr><td><strong>Minimum supported server:</strong></td><td>Windows Server 2003 [desktop apps | UWP apps]</td></tr></tbody></table>
</p>
<p>Microsoft Docs page: <a href="https://docs.microsoft.com/en-us/windows/desktop/api/Winuser/nf-winuser-formatmessagew">FormatMessageW function</a></p>
</div>
  <h5 class="exceptions">Exceptions</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Condition</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.dllnotfoundexception">DllNotFoundException</a></td>
        <td><p>The native library containg the function could not be found.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.entrypointnotfoundexception">EntryPointNotFoundException</a></td>
        <td><p>Unable to find the entry point for the function in the native library.</p>
</td>
      </tr>
    </tbody>
  </table>
  
  
  <a id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FormatMessage_" data-uid="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.FormatMessage*"></a>
  <h4 id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FormatMessage_THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_OPTIONS_System_String_System_Int32_System_Int32_System_Text_StringBuilder_System_Int32_System_IntPtr_" data-uid="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.FormatMessage(THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_OPTIONS,System.String,System.Int32,System.Int32,System.Text.StringBuilder,System.Int32,System.IntPtr)">FormatMessage(FORMAT_MESSAGE_OPTIONS, String, Int32, Int32, StringBuilder, Int32, IntPtr)</h4>
  <div class="markdown level1 summary"><p>Formats a message string. The function requires a message definition as input.
It can come from a message table resource in an already-loaded module.
Or the caller can ask the function to search the system's message table resource(s) for the message definition.
The function finds the message definition in a message table resource based on a message identifier and a language identifier.
The function copies the formatted message text to an output buffer, processing any embedded insert sequences if requested.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static int FormatMessage(FORMAT_MESSAGE_OPTIONS dwFlags, string lpSource, int dwMessageId, int dwLanguageId, StringBuilder lpBuffer, int nSize, IntPtr Arguments)</code></pre>
  </div>
  <h5 class="parameters">Parameters</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_OPTIONS.html">FORMAT_MESSAGE_OPTIONS</a></td>
        <td><span class="parametername">dwFlags</span></td>
        <td><p>
The formatting options, and how to interpret the <code data-dev-comment-type="paramref" class="paramref">lpSource</code> parameter.
The <a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_OPTIONS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_OPTIONS_Width">Width</a> property specifies how the function handles line breaks in the output buffer. It can also specify the maximum width of a formatted output line.
</p>
<p>
The function ignores regular line breaks in the message definition text. The function never splits a string delimited by white space across a line break. The function stores hard-coded line breaks in the message definition text into the output buffer. Hard-coded line breaks are coded with the <code>%n</code> escape sequence.
</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.string">String</a></td>
        <td><span class="parametername">lpSource</span></td>
        <td><p>A string that consists of unformatted message text. It will be scanned for inserts and formatted accordingly.</p>
<p>Only use this overload if the <a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_FLAGS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_FLAGS_FORMAT_MESSAGE_FROM_STRING">FORMAT_MESSAGE_FROM_STRING</a> flag is set in <code data-dev-comment-type="paramref" class="paramref">dwFlags</code>. Otherwise, set this parameter to <code>null</code>.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.int32">Int32</a></td>
        <td><span class="parametername">dwMessageId</span></td>
        <td><p>The message identifier for the requested message. This parameter is ignored if<code data-dev-comment-type="paramref" class="paramref">dwFlags</code> includes <a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_FLAGS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_FLAGS_FORMAT_MESSAGE_FROM_STRING">FORMAT_MESSAGE_FROM_STRING</a>.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.int32">Int32</a></td>
        <td><span class="parametername">dwLanguageId</span></td>
        <td><p>The language identifier for the requested message. This parameter is ignored if <code data-dev-comment-type="paramref" class="paramref">dwFlags</code> includes <a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_FLAGS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_FLAGS_FORMAT_MESSAGE_FROM_STRING">FORMAT_MESSAGE_FROM_STRING</a>.</p>
<p>
If you pass a specific LCID in this parameter, <a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FormatMessage_THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_OPTIONS_System_String_System_Int32_System_Int32_System_Text_StringBuilder_System_Int32_System_IntPtr_">FormatMessage(FORMAT_MESSAGE_OPTIONS, String, Int32, Int32, StringBuilder, Int32, IntPtr)</a> will return a message for that LCID only.
If the function cannot find a message for that LCID, it sets Last-Error to <a class="xref" href="THNETII.WinApi.Native.WinError.WinErrorConstants.html#THNETII_WinApi_Native_WinError_WinErrorConstants_ERROR_RESOURCE_LANG_NOT_FOUND">ERROR_RESOURCE_LANG_NOT_FOUND</a>.
If you pass in <code>0</code> (zero), <a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FormatMessage_THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_OPTIONS_System_String_System_Int32_System_Int32_System_Text_StringBuilder_System_Int32_System_IntPtr_">FormatMessage(FORMAT_MESSAGE_OPTIONS, String, Int32, Int32, StringBuilder, Int32, IntPtr)</a> looks for a message for LCIDs in the following order:
<ol><li>Language neutral</li><li>Thread LCID, based on the thread&apos;s locale value</li><li>User default LCID, based on the user&apos;s default locale value</li><li>System default LCID, based on the system default locale value</li><li>US English</li></ol>
</p>
<p>
If <a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FormatMessage_THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_OPTIONS_System_String_System_Int32_System_Int32_System_Text_StringBuilder_System_Int32_System_IntPtr_">FormatMessage(FORMAT_MESSAGE_OPTIONS, String, Int32, Int32, StringBuilder, Int32, IntPtr)</a> does not locate a message for any of the preceding LCIDs,
it returns any language message string that is present. If that fails, it returns <a class="xref" href="THNETII.WinApi.Native.WinError.WinErrorConstants.html#THNETII_WinApi_Native_WinError_WinErrorConstants_ERROR_RESOURCE_LANG_NOT_FOUND">ERROR_RESOURCE_LANG_NOT_FOUND</a>. 
</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.text.stringbuilder">StringBuilder</a></td>
        <td><span class="parametername">lpBuffer</span></td>
        <td><p>A buffer that receives the the string that specifies the formatted message.</p>
<p><strong>DO NOT</strong> use this overload with the <a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_FLAGS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_FLAGS_FORMAT_MESSAGE_ALLOCATE_BUFFER">FORMAT_MESSAGE_ALLOCATE_BUFFER</a> flag set in <code data-dev-comment-type="paramref" class="paramref">dwFlags</code>!</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.int32">Int32</a></td>
        <td><span class="parametername">nSize</span></td>
        <td><p>Specifies the <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.text.stringbuilder.capacity#System_Text_StringBuilder_Capacity">Capacity</a> of <code data-dev-comment-type="paramref" class="paramref">lpBuffer</code>.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.intptr">IntPtr</a></td>
        <td><span class="parametername">Arguments</span></td>
        <td><p>A pointer to an array of values that are used as insert values in the formatted message. A <code>%1</code> in the format string indicates the first value in the Arguments array; a <code>%2</code> indicates the second argument; and so on.</p>
<p>The interpretation of each value depends on the formatting information associated with the insert in the message definition. The default is to treat each value as a pointer to a null-terminated unicode string.</p>
<p><strong>DO NOT</strong> use this parameter if the <a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_FLAGS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_FLAGS_FORMAT_MESSAGE_ARGUMENT_ARRAY">FORMAT_MESSAGE_ARGUMENT_ARRAY</a> flag is not set in <code data-dev-comment-type="paramref" class="paramref">dwFlags</code>!</p>
<p>The default value of <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.intptr.zero">Zero</a> can be used to indicate no insert arguments. This should be used when the <a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_FLAGS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_FLAGS_FORMAT_MESSAGE_IGNORE_INSERTS">FORMAT_MESSAGE_IGNORE_INSERTS</a> flag is set in <code data-dev-comment-type="paramref" class="paramref">dwFlags</code></p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.int32">Int32</a></td>
        <td><p>
If the function succeeds, the return value is the number of characters stored in the output buffer, excluding the terminating null character.
</p>
<p>If the function fails, the return value is <code>0</code> (zero). To get extended error information, call <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.runtime.interopservices.marshal.getlastwin32error#System_Runtime_InteropServices_Marshal_GetLastWin32Error">GetLastWin32Error()</a>.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FormatMessage_THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_OPTIONS_System_String_System_Int32_System_Int32_System_Text_StringBuilder_System_Int32_System_IntPtr__remarks">Remarks</h5>
  <div class="markdown level1 remarks"><p>
Within the message text, several escape sequences are supported for dynamically formatting the message. These escape sequences and their meanings are shown in the following tables. All escape sequences start with the percent character (%).
<table><thead><tr><th>Escape sequence</th><th>Meaning</th></tr></thead><tbody><tr><td><code>%0</code></td><td>Terminates a message text line without a trailing new line character. This escape sequence can be used to build up long lines or to terminate the message itself without a trailing new line character. It is useful for prompt messages.</td></tr><tr><td><code>%n!<em>format string</em>!</code></td><td>
<p>Identifies an insert. The value of <em>n</em> can be in the range from 1 through 99. The format string (which must be surrounded by exclamation marks) is optional and defaults to <code>!s!</code> if not specified. For more information, see <a href="http://go.microsoft.com/fwlink/p/?linkid=83949">Format Specification Fields</a>.</p>
<p>The format string can include a width and precision specifier for strings and a width specifier for integers. Use an asterisk (<code>*</code>) to specify the width and precision. For example, <code>%1!.*s!</code> or <code>%1!*u!</code>.</p>
<p>If you do not use the width and precision specifiers, the insert numbers correspond directly to the input arguments. For example, if the source string is <code>&quot;%1 %2 %1&quot;</code> and the input arguments are <code>&quot;Bill&quot;</code> and <code>&quot;Bob&quot;</code>, the formatted output string is <code>&quot;Bill Bob Bill&quot;</code>.</p>
<p>However, if you use a width and precision specifier, the insert numbers do not correspond directly to the input arguments. For example, the insert numbers for the previous example could change to <code>&quot;%1!*.*s! %4 %5!*s!&quot;</code>.</p>
<p>The next insert number is <code>n + 2</code> if the previous format string contained one asterisk and is <code>n + 3</code> if two asterisks were specified.</p>
<p>If you want to repeat <code>&quot;Bill&quot;</code>, as in the previous example, the arguments must include <code>&quot;Bill&quot;</code> twice. For example, if the source string is <code>&quot;%1!*.*s! %4 %5!*s!&quot;</code>, the arguments could be, <code>4</code>, <code>2</code>, <code>&quot;Bill&quot;</code>, <code>&quot;Bob&quot;</code>, <code>6</code>, <code>&quot;Bill&quot;</code> (if using the <a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_FLAGS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_FLAGS_FORMAT_MESSAGE_ARGUMENT_ARRAY">FORMAT_MESSAGE_ARGUMENT_ARRAY</a> flag). The formatted string would then be <code>&quot;  Bi Bob   Bill&quot;</code>.</p>
<p>Repeating insert numbers when the source string contains width and precision specifiers may not yield the intended results. If you replaced <code>%5</code> with <code>%1</code>, the function would try to print a string at address 6 (likely resulting in an access violation).</p>
<p>Floating-point format specifiers—<code>e</code>, <code>E</code>, <code>f</code>, and <code>g</code>—are not supported. The workaround is to pre-format floating-point number using the regular <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.double.tostring#System_Double_ToString">ToString()</a> method and then insert that string.</p>
<p>Inserts that use the <code>I64</code> prefix are treated as two 32-bit arguments.</p>
</td></tr></tbody></table>
</p>
<p>
Any other nondigit character following a percent character is formatted in the output message without the percent character. Following are some examples.
<table><thead><tr><th>Format string</th><th>Resulting output</th></tr></thead><tbody><tr><td><code>%%</code></td><td>A single percent sign.</td></tr><tr><td><code>%<em>space</em></code></td><td>A single space. This format string can be used to ensure the appropriate number of trailing spaces in a message text line.</td></tr><tr><td><code>%.</code></td><td>A single period. This format string can be used to include a single period at the beginning of a line without terminating the message text definition.</td></tr><tr><td><code>%!</code></td><td>A single exclamation point. This format string can be used to include an exclamation point immediately after an insert without its being mistaken for the beginning of a format string.</td></tr><tr><td><code>%n</code></td><td>A hard line break when the format string occurs at the end of a line. This format string is useful when <a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FormatMessage_THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_OPTIONS_System_String_System_Int32_System_Int32_System_Text_StringBuilder_System_Int32_System_IntPtr_">FormatMessage(FORMAT_MESSAGE_OPTIONS, String, Int32, Int32, StringBuilder, Int32, IntPtr)</a> is supplying regular line breaks so the message fits in a certain width.</td></tr><tr><td><code>%r</code></td><td>A hard carriage return without a trailing newline character.</td></tr><tr><td><code>%t</code></td><td>A single tab.</td></tr></tbody></table>
</p>
<p>
<strong>Security Remarks</strong><br>
If this function is called without <a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_FLAGS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_FLAGS_FORMAT_MESSAGE_IGNORE_INSERTS">FORMAT_MESSAGE_IGNORE_INSERTS</a>, the <code data-dev-comment-type="paramref" class="paramref">Arguments</code> parameter must contain enough parameters to satisfy all insertion sequences in the message string, and they must be of the correct type. Therefore, do not use untrusted or unknown message strings with inserts enabled because they can contain more insertion sequences than <code data-dev-comment-type="paramref" class="paramref">Arguments</code> provides, or those that may be of the wrong type. In particular, it is unsafe to take an arbitrary system error code returned from an API and use <a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_FLAGS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_FLAGS_FORMAT_MESSAGE_FROM_SYSTEM">FORMAT_MESSAGE_FROM_SYSTEM</a> without <a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_FLAGS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_FLAGS_FORMAT_MESSAGE_IGNORE_INSERTS">FORMAT_MESSAGE_IGNORE_INSERTS</a>. 
</p>
<p>
<table><thead><tr><th>Requirements</th><th></th></tr></thead><tbody><tr><td><strong>Minimum supported client:</strong></td><td>Windows XP [desktop apps | UWP apps]</td></tr><tr><td><strong>Minimum supported server:</strong></td><td>Windows Server 2003 [desktop apps | UWP apps]</td></tr></tbody></table>
</p>
<p>Microsoft Docs page: <a href="https://docs.microsoft.com/en-us/windows/desktop/api/Winuser/nf-winuser-formatmessagew">FormatMessageW function</a></p>
</div>
  <h5 class="exceptions">Exceptions</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Condition</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.dllnotfoundexception">DllNotFoundException</a></td>
        <td><p>The native library containg the function could not be found.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.entrypointnotfoundexception">EntryPointNotFoundException</a></td>
        <td><p>Unable to find the entry point for the function in the native library.</p>
</td>
      </tr>
    </tbody>
  </table>
  
  
  <a id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FormatMessage_" data-uid="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.FormatMessage*"></a>
  <h4 id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FormatMessage_THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_OPTIONS_System_String_System_Int32_System_Int32_THNETII_InteropServices_NativeMemory_Specialized_WideStringPtr__System_Int32_System_IntPtr_" data-uid="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.FormatMessage(THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_OPTIONS,System.String,System.Int32,System.Int32,THNETII.InteropServices.NativeMemory.Specialized.WideStringPtr@,System.Int32,System.IntPtr)">FormatMessage(FORMAT_MESSAGE_OPTIONS, String, Int32, Int32, out WideStringPtr, Int32, IntPtr)</h4>
  <div class="markdown level1 summary"><p>Formats a message string. The function requires a message definition as input.
It can come from a message table resource in an already-loaded module.
Or the caller can ask the function to search the system's message table resource(s) for the message definition.
The function finds the message definition in a message table resource based on a message identifier and a language identifier.
The function copies the formatted message text to an output buffer, processing any embedded insert sequences if requested.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static int FormatMessage(FORMAT_MESSAGE_OPTIONS dwFlags, string lpSource, int dwMessageId, int dwLanguageId, out WideStringPtr lpBuffer, int nSize, IntPtr Arguments)</code></pre>
  </div>
  <h5 class="parameters">Parameters</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_OPTIONS.html">FORMAT_MESSAGE_OPTIONS</a></td>
        <td><span class="parametername">dwFlags</span></td>
        <td><p>
The formatting options, and how to interpret the <code data-dev-comment-type="paramref" class="paramref">lpSource</code> parameter.
The <a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_OPTIONS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_OPTIONS_Width">Width</a> property specifies how the function handles line breaks in the output buffer. It can also specify the maximum width of a formatted output line.
</p>
<p>
The function ignores regular line breaks in the message definition text. The function never splits a string delimited by white space across a line break. The function stores hard-coded line breaks in the message definition text into the output buffer. Hard-coded line breaks are coded with the <code>%n</code> escape sequence.
</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.string">String</a></td>
        <td><span class="parametername">lpSource</span></td>
        <td><p>A string that consists of unformatted message text. It will be scanned for inserts and formatted accordingly.</p>
<p>Only use this overload if the <a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_FLAGS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_FLAGS_FORMAT_MESSAGE_FROM_STRING">FORMAT_MESSAGE_FROM_STRING</a> flag is set in <code data-dev-comment-type="paramref" class="paramref">dwFlags</code>. Otherwise, set this parameter to <code>null</code>.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.int32">Int32</a></td>
        <td><span class="parametername">dwMessageId</span></td>
        <td><p>The message identifier for the requested message. This parameter is ignored if<code data-dev-comment-type="paramref" class="paramref">dwFlags</code> includes <a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_FLAGS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_FLAGS_FORMAT_MESSAGE_FROM_STRING">FORMAT_MESSAGE_FROM_STRING</a>.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.int32">Int32</a></td>
        <td><span class="parametername">dwLanguageId</span></td>
        <td><p>The language identifier for the requested message. This parameter is ignored if <code data-dev-comment-type="paramref" class="paramref">dwFlags</code> includes <a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_FLAGS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_FLAGS_FORMAT_MESSAGE_FROM_STRING">FORMAT_MESSAGE_FROM_STRING</a>.</p>
<p>
If you pass a specific LCID in this parameter, <a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FormatMessage_THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_OPTIONS_System_String_System_Int32_System_Int32_THNETII_InteropServices_NativeMemory_Specialized_WideStringPtr__System_Int32_System_IntPtr_">FormatMessage(FORMAT_MESSAGE_OPTIONS, String, Int32, Int32, out WideStringPtr, Int32, IntPtr)</a> will return a message for that LCID only.
If the function cannot find a message for that LCID, it sets Last-Error to <a class="xref" href="THNETII.WinApi.Native.WinError.WinErrorConstants.html#THNETII_WinApi_Native_WinError_WinErrorConstants_ERROR_RESOURCE_LANG_NOT_FOUND">ERROR_RESOURCE_LANG_NOT_FOUND</a>.
If you pass in <code>0</code> (zero), <a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FormatMessage_THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_OPTIONS_System_String_System_Int32_System_Int32_THNETII_InteropServices_NativeMemory_Specialized_WideStringPtr__System_Int32_System_IntPtr_">FormatMessage(FORMAT_MESSAGE_OPTIONS, String, Int32, Int32, out WideStringPtr, Int32, IntPtr)</a> looks for a message for LCIDs in the following order:
<ol><li>Language neutral</li><li>Thread LCID, based on the thread&apos;s locale value</li><li>User default LCID, based on the user&apos;s default locale value</li><li>System default LCID, based on the system default locale value</li><li>US English</li></ol>
</p>
<p>
If <a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FormatMessage_THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_OPTIONS_System_String_System_Int32_System_Int32_System_Text_StringBuilder_System_Int32_System_IntPtr_">FormatMessage(FORMAT_MESSAGE_OPTIONS, String, Int32, Int32, StringBuilder, Int32, IntPtr)</a> does not locate a message for any of the preceding LCIDs,
it returns any language message string that is present. If that fails, it returns <a class="xref" href="THNETII.WinApi.Native.WinError.WinErrorConstants.html#THNETII_WinApi_Native_WinError_WinErrorConstants_ERROR_RESOURCE_LANG_NOT_FOUND">ERROR_RESOURCE_LANG_NOT_FOUND</a>. 
</p>
</td>
      </tr>
      <tr>
        <td><span class="xref">THNETII.InteropServices.NativeMemory.Specialized.WideStringPtr</span></td>
        <td><span class="parametername">lpBuffer</span></td>
        <td><p>Receives a buffer to the null-terminated string that specifies the formatted message. <strong>ONLY</strong> use this overload if <a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_FLAGS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_FLAGS_FORMAT_MESSAGE_ALLOCATE_BUFFER">FORMAT_MESSAGE_ALLOCATE_BUFFER</a> is included in <code data-dev-comment-type="paramref" class="paramref">dwFlags</code>.</p>
<p>The function allocates a buffer using the <see cref="!:LocalAlloc"></see> function.</p>
<p>This buffer cannot be larger than 64K bytes.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.int32">Int32</a></td>
        <td><span class="parametername">nSize</span></td>
        <td><p>Specifies the minimum number of characters to allocate for the output buffer to return in <code data-dev-comment-type="paramref" class="paramref">lpBuffer</code>.</p>
<p>The output buffer cannot be larger than 64K bytes.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.intptr">IntPtr</a></td>
        <td><span class="parametername">Arguments</span></td>
        <td><p>A pointer to an array of values that are used as insert values in the formatted message. A <code>%1</code> in the format string indicates the first value in the Arguments array; a <code>%2</code> indicates the second argument; and so on.</p>
<p>The interpretation of each value depends on the formatting information associated with the insert in the message definition. The default is to treat each value as a pointer to a null-terminated unicode string.</p>
<p><strong>DO NOT</strong> use this parameter if the <a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_FLAGS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_FLAGS_FORMAT_MESSAGE_ARGUMENT_ARRAY">FORMAT_MESSAGE_ARGUMENT_ARRAY</a> flag is not set in <code data-dev-comment-type="paramref" class="paramref">dwFlags</code>!</p>
<p>The default value of <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.intptr.zero">Zero</a> can be used to indicate no insert arguments. This should be used when the <a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_FLAGS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_FLAGS_FORMAT_MESSAGE_IGNORE_INSERTS">FORMAT_MESSAGE_IGNORE_INSERTS</a> flag is set in <code data-dev-comment-type="paramref" class="paramref">dwFlags</code></p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.int32">Int32</a></td>
        <td><p>
If the function succeeds, the return value is the number of characters stored in the output buffer, excluding the terminating null character.
</p>
<p>If the function fails, the return value is <code>0</code> (zero). To get extended error information, call <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.runtime.interopservices.marshal.getlastwin32error#System_Runtime_InteropServices_Marshal_GetLastWin32Error">GetLastWin32Error()</a>.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FormatMessage_THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_OPTIONS_System_String_System_Int32_System_Int32_THNETII_InteropServices_NativeMemory_Specialized_WideStringPtr__System_Int32_System_IntPtr__remarks">Remarks</h5>
  <div class="markdown level1 remarks"><p>
Within the message text, several escape sequences are supported for dynamically formatting the message. These escape sequences and their meanings are shown in the following tables. All escape sequences start with the percent character (%).
<table><thead><tr><th>Escape sequence</th><th>Meaning</th></tr></thead><tbody><tr><td><code>%0</code></td><td>Terminates a message text line without a trailing new line character. This escape sequence can be used to build up long lines or to terminate the message itself without a trailing new line character. It is useful for prompt messages.</td></tr><tr><td><code>%n!<em>format string</em>!</code></td><td>
<p>Identifies an insert. The value of <em>n</em> can be in the range from 1 through 99. The format string (which must be surrounded by exclamation marks) is optional and defaults to <code>!s!</code> if not specified. For more information, see <a href="http://go.microsoft.com/fwlink/p/?linkid=83949">Format Specification Fields</a>.</p>
<p>The format string can include a width and precision specifier for strings and a width specifier for integers. Use an asterisk (<code>*</code>) to specify the width and precision. For example, <code>%1!.*s!</code> or <code>%1!*u!</code>.</p>
<p>If you do not use the width and precision specifiers, the insert numbers correspond directly to the input arguments. For example, if the source string is <code>&quot;%1 %2 %1&quot;</code> and the input arguments are <code>&quot;Bill&quot;</code> and <code>&quot;Bob&quot;</code>, the formatted output string is <code>&quot;Bill Bob Bill&quot;</code>.</p>
<p>However, if you use a width and precision specifier, the insert numbers do not correspond directly to the input arguments. For example, the insert numbers for the previous example could change to <code>&quot;%1!*.*s! %4 %5!*s!&quot;</code>.</p>
<p>The next insert number is <code>n + 2</code> if the previous format string contained one asterisk and is <code>n + 3</code> if two asterisks were specified.</p>
<p>If you want to repeat <code>&quot;Bill&quot;</code>, as in the previous example, the arguments must include <code>&quot;Bill&quot;</code> twice. For example, if the source string is <code>&quot;%1!*.*s! %4 %5!*s!&quot;</code>, the arguments could be, <code>4</code>, <code>2</code>, <code>&quot;Bill&quot;</code>, <code>&quot;Bob&quot;</code>, <code>6</code>, <code>&quot;Bill&quot;</code> (if using the <a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_FLAGS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_FLAGS_FORMAT_MESSAGE_ARGUMENT_ARRAY">FORMAT_MESSAGE_ARGUMENT_ARRAY</a> flag). The formatted string would then be <code>&quot;  Bi Bob   Bill&quot;</code>.</p>
<p>Repeating insert numbers when the source string contains width and precision specifiers may not yield the intended results. If you replaced <code>%5</code> with <code>%1</code>, the function would try to print a string at address 6 (likely resulting in an access violation).</p>
<p>Floating-point format specifiers—<code>e</code>, <code>E</code>, <code>f</code>, and <code>g</code>—are not supported. The workaround is to pre-format floating-point number using the regular <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.double.tostring#System_Double_ToString">ToString()</a> method and then insert that string.</p>
<p>Inserts that use the <code>I64</code> prefix are treated as two 32-bit arguments.</p>
</td></tr></tbody></table>
</p>
<p>
Any other nondigit character following a percent character is formatted in the output message without the percent character. Following are some examples.
<table><thead><tr><th>Format string</th><th>Resulting output</th></tr></thead><tbody><tr><td><code>%%</code></td><td>A single percent sign.</td></tr><tr><td><code>%<em>space</em></code></td><td>A single space. This format string can be used to ensure the appropriate number of trailing spaces in a message text line.</td></tr><tr><td><code>%.</code></td><td>A single period. This format string can be used to include a single period at the beginning of a line without terminating the message text definition.</td></tr><tr><td><code>%!</code></td><td>A single exclamation point. This format string can be used to include an exclamation point immediately after an insert without its being mistaken for the beginning of a format string.</td></tr><tr><td><code>%n</code></td><td>A hard line break when the format string occurs at the end of a line. This format string is useful when <a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FormatMessage_THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_OPTIONS_System_String_System_Int32_System_Int32_THNETII_InteropServices_NativeMemory_Specialized_WideStringPtr__System_Int32_System_IntPtr_">FormatMessage(FORMAT_MESSAGE_OPTIONS, String, Int32, Int32, out WideStringPtr, Int32, IntPtr)</a> is supplying regular line breaks so the message fits in a certain width.</td></tr><tr><td><code>%r</code></td><td>A hard carriage return without a trailing newline character.</td></tr><tr><td><code>%t</code></td><td>A single tab.</td></tr></tbody></table>
</p>
<p>
<strong>Security Remarks</strong><br>
If this function is called without <a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_FLAGS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_FLAGS_FORMAT_MESSAGE_IGNORE_INSERTS">FORMAT_MESSAGE_IGNORE_INSERTS</a>, the <code data-dev-comment-type="paramref" class="paramref">Arguments</code> parameter must contain enough parameters to satisfy all insertion sequences in the message string, and they must be of the correct type. Therefore, do not use untrusted or unknown message strings with inserts enabled because they can contain more insertion sequences than <code data-dev-comment-type="paramref" class="paramref">Arguments</code> provides, or those that may be of the wrong type. In particular, it is unsafe to take an arbitrary system error code returned from an API and use <a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_FLAGS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_FLAGS_FORMAT_MESSAGE_FROM_SYSTEM">FORMAT_MESSAGE_FROM_SYSTEM</a> without <a class="xref" href="THNETII.WinApi.Native.WinBase.FORMAT_MESSAGE_FLAGS.html#THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_FLAGS_FORMAT_MESSAGE_IGNORE_INSERTS">FORMAT_MESSAGE_IGNORE_INSERTS</a>. 
</p>
<p>
<table><thead><tr><th>Requirements</th><th></th></tr></thead><tbody><tr><td><strong>Minimum supported client:</strong></td><td>Windows XP [desktop apps | UWP apps]</td></tr><tr><td><strong>Minimum supported server:</strong></td><td>Windows Server 2003 [desktop apps | UWP apps]</td></tr></tbody></table>
</p>
<p>Microsoft Docs page: <a href="https://docs.microsoft.com/en-us/windows/desktop/api/Winuser/nf-winuser-formatmessagew">FormatMessageW function</a></p>
</div>
  <h5 class="exceptions">Exceptions</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Condition</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.dllnotfoundexception">DllNotFoundException</a></td>
        <td><p>The native library containg the function could not be found.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.entrypointnotfoundexception">EntryPointNotFoundException</a></td>
        <td><p>Unable to find the entry point for the function in the native library.</p>
</td>
      </tr>
    </tbody>
  </table>
  
  
  <a id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_GetErrorMode_" data-uid="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.GetErrorMode*"></a>
  <h4 id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_GetErrorMode" data-uid="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.GetErrorMode">GetErrorMode()</h4>
  <div class="markdown level1 summary"><p>Retrieves the error mode for the current process.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static SYSTEM_ERROR_MODE GetErrorMode()</code></pre>
  </div>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="THNETII.WinApi.Native.WinBase.SYSTEM_ERROR_MODE.html">SYSTEM_ERROR_MODE</a></td>
        <td><p>The process error mode.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_GetErrorMode_remarks">Remarks</h5>
  <div class="markdown level1 remarks"><p>Each process has an associated error mode that indicates to the system how the application is going to respond to serious errors. A child process inherits the error mode of its parent process.</p>
<p>To change the error mode for the process, use the <a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_SetErrorMode_THNETII_WinApi_Native_WinBase_SYSTEM_ERROR_MODE_">SetErrorMode(SYSTEM_ERROR_MODE)</a> function.</p>
<p>
<strong>Windows 7:</strong><br>
Callers should favor <see cref="!:SetThreadErrorMode"></see> over <a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_SetErrorMode_THNETII_WinApi_Native_WinBase_SYSTEM_ERROR_MODE_">SetErrorMode(SYSTEM_ERROR_MODE)</a> since it is less disruptive to the normal behavior of the system. <a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_GetThreadErrorMode">GetThreadErrorMode()</a> is the call function that corresponds to <a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_GetErrorMode">GetErrorMode()</a>.
</p>
<p>
<table><thead><tr><th>Requirements</th><th></th></tr></thead><tbody><tr><td><strong>Minimum supported client:</strong></td><td>Windows Vista [desktop apps only]</td></tr><tr><td><strong>Minimum supported server:</strong></td><td>Windows Server 2008 [desktop apps only]</td></tr></tbody></table>
</p>
<p>Microsoft Docs page: <a href="https://msdn.microsoft.com/en-us/library/ms679355.aspx">GetErrorMode function</a></p>
</div>
  <h5 class="exceptions">Exceptions</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Condition</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.dllnotfoundexception">DllNotFoundException</a></td>
        <td><p>The native library containg the function could not be found.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.entrypointnotfoundexception">EntryPointNotFoundException</a></td>
        <td><p>Unable to find the entry point for the function in the native library.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_GetErrorMode_seealso">See Also</h5>
  <div class="seealso">
      <div><a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_SetErrorMode_THNETII_WinApi_Native_WinBase_SYSTEM_ERROR_MODE_">SetErrorMode(SYSTEM_ERROR_MODE)</a></div>
      <div><a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_GetThreadErrorMode">GetThreadErrorMode()</a></div>
  </div>
  
  
  <a id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_GetLastError_" data-uid="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.GetLastError*"></a>
  <h4 id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_GetLastError" data-uid="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.GetLastError">GetLastError()</h4>
  <div class="markdown level1 summary"><p>Retrieves the calling thread's last-error code value. The last-error code is maintained on a per-thread basis. Multiple threads do not overwrite each other's last-error code.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">[Obsolete(&quot;.NET Applications should not call GetLastError. Instead the static System.Runtime.InteropServices.Marshal.GetLastWin32Error() method should be used.&quot;)]
public static int GetLastError()</code></pre>
  </div>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.int32">Int32</a></td>
        <td><p>The return value is the calling thread&apos;s last-error code.</p>
<p>The Return Value section of the documentation for each function that sets the last-error code notes the conditions under which the function sets the last-error code. Most functions that set the thread&apos;s last-error code set it when they fail. However, some functions also set the last-error code when they succeed. If the function is not documented to set the last-error code, the value returned by this function is simply the most recent last-error code to have been set; some functions set the last-error code to <code>0</code> (zero) on success and others do not.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_GetLastError_remarks">Remarks</h5>
  <div class="markdown level1 remarks"><p>Functions executed by the calling thread set this value by calling the <see cref="!:SetLastError"></see> function. You should call the <a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_GetLastError">GetLastError()</a> function immediately when a function&apos;s return value indicates that such a call will return useful data. That is because some functions call <see cref="!:SetLastError"></see> with a zero when they succeed, wiping out the error code set by the most recently failed function.</p>
<p>To obtain an error string for system error codes, use the <a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FormatMessage_THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_OPTIONS_System_IntPtr_System_Int32_System_Int32_System_Text_StringBuilder_System_Int32_System_IntPtr_">FormatMessage(FORMAT_MESSAGE_OPTIONS, IntPtr, Int32, Int32, StringBuilder, Int32, IntPtr)</a> function. For a complete list of error codes provided by the operating system, see <a href="https://msdn.microsoft.com/en-us/library/ms681381.aspx">System Error Codes</a>.</p>
<p>The error codes returned by a function are not part of the Windows API specification and can vary by operating system or device driver. For this reason, we cannot provide the complete list of error codes that can be returned by each function. There are also many functions whose documentation does not include even a partial list of error codes that can be returned.</p>
<p>Error codes are 32-bit values (bit 31 is the most significant bit). Bit 29 is reserved for application-defined error codes; no system error code has this bit set. If you are defining an error code for your application, set this bit to one. That indicates that the error code has been defined by an application, and ensures that your error code does not conflict with any error codes defined by the system.</p>
<p>To convert a system error into an <span class="xref">THNETII.WindowsProtocols.WindowsErrorCodes.HRESULT</span> value, use the <span class="xref">THNETII.WindowsProtocols.WindowsErrorCodes.HRESULT.FromWin32(System.Int32)</span> function.</p>
<p>
<table><thead><tr><th>Requirements</th><th></th></tr></thead><tbody><tr><td><strong>Minimum supported client:</strong></td><td>Windows XP [desktop apps | UWP apps]</td></tr><tr><td><strong>Minimum supported server:</strong></td><td>Windows Server 2003 [desktop apps | UWP apps]</td></tr><tr><td><strong>Minimum supported phone:</strong></td><td>Windows Phone 8</td></tr></tbody></table>
</p>
<p>Microsoft Docs page: <a href="https://msdn.microsoft.com/en-us/library/ms679360.aspx">GetLastError function</a></p>
</div>
  <h5 class="exceptions">Exceptions</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Condition</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.dllnotfoundexception">DllNotFoundException</a></td>
        <td><p>The native library containg the function could not be found.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.entrypointnotfoundexception">EntryPointNotFoundException</a></td>
        <td><p>Unable to find the entry point for the function in the native library.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_GetLastError_seealso">See Also</h5>
  <div class="seealso">
      <div><a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FormatMessage_THNETII_WinApi_Native_WinBase_FORMAT_MESSAGE_OPTIONS_System_IntPtr_System_Int32_System_Int32_System_Text_StringBuilder_System_Int32_System_IntPtr_">FormatMessage(FORMAT_MESSAGE_OPTIONS, IntPtr, Int32, Int32, StringBuilder, Int32, IntPtr)</a></div>
      <div><span class="xref">THNETII.WindowsProtocols.WindowsErrorCodes.HRESULT.FromWin32(System.Int32)</span></div>
  </div>
  
  
  <a id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_GetThreadErrorMode_" data-uid="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.GetThreadErrorMode*"></a>
  <h4 id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_GetThreadErrorMode" data-uid="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.GetThreadErrorMode">GetThreadErrorMode()</h4>
  <div class="markdown level1 summary"><p>Retrieves the error mode for the calling thread.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static SYSTEM_ERROR_MODE GetThreadErrorMode()</code></pre>
  </div>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="THNETII.WinApi.Native.WinBase.SYSTEM_ERROR_MODE.html">SYSTEM_ERROR_MODE</a></td>
        <td><p>The process error mode for the calling thread.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_GetThreadErrorMode_remarks">Remarks</h5>
  <div class="markdown level1 remarks"><p>A thread inherits the error mode of the process in which it is running. To change the error mode for the thread, use the <see cref="!:SetThreadErrorMode"></see> function.</p>
<p>
<table><thead><tr><th>Requirements</th><th></th></tr></thead><tbody><tr><td><strong>Minimum supported client:</strong></td><td>Windows 7 [desktop apps | UWP apps]</td></tr><tr><td><strong>Minimum supported server:</strong></td><td>Windows Server 2008 R2 [desktop apps | UWP apps]</td></tr></tbody></table>
</p>
<p>Microsoft Docs page: <a href="https://msdn.microsoft.com/en-us/library/Dd553629.aspx">GetThreadErrorMode function</a></p>
</div>
  <h5 class="exceptions">Exceptions</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Condition</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.dllnotfoundexception">DllNotFoundException</a></td>
        <td><p>The native library containg the function could not be found.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.entrypointnotfoundexception">EntryPointNotFoundException</a></td>
        <td><p>Unable to find the entry point for the function in the native library.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_GetThreadErrorMode_seealso">See Also</h5>
  <div class="seealso">
      <div><a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_GetErrorMode">GetErrorMode()</a></div>
  </div>
  
  
  <a id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_MessageBeep_" data-uid="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.MessageBeep*"></a>
  <h4 id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_MessageBeep_THNETII_WinApi_Native_WinUser_MB_ICON_" data-uid="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.MessageBeep(THNETII.WinApi.Native.WinUser.MB_ICON)">MessageBeep(MB_ICON)</h4>
  <div class="markdown level1 summary"><p>Plays a waveform sound. The waveform sound for each sound type is identified by an entry in the registry.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static bool MessageBeep(MB_ICON uType)</code></pre>
  </div>
  <h5 class="parameters">Parameters</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="THNETII.WinApi.Native.WinUser.MB_ICON.html">MB_ICON</a></td>
        <td><span class="parametername">uType</span></td>
        <td><p>The sound to be played. The sounds are set by the user through the Sound control panel application, and then stored in the registry.</p>
<p>
This parameter can be one of the following values.
<table><thead><tr><th>Value</th><th>Meaning</th></tr></thead><tbody><tr><td><code>(<a class="xref" href="THNETII.WinApi.Native.WinUser.MB_ICON.html">MB_ICON</a>)0xFFFFFFFF</code></td><td>A simple beep. If the sound card is not available, the sound is generated using the speaker. </td></tr><tr><td><a class="xref" href="THNETII.WinApi.Native.WinUser.MB_ICON.html#THNETII_WinApi_Native_WinUser_MB_ICON_MB_ICONASTERISK">MB_ICONASTERISK</a></td><td>See <a class="xref" href="THNETII.WinApi.Native.WinUser.MB_ICON.html#THNETII_WinApi_Native_WinUser_MB_ICON_MB_ICONINFORMATION">MB_ICONINFORMATION</a>.</td></tr><tr><td><a class="xref" href="THNETII.WinApi.Native.WinUser.MB_ICON.html#THNETII_WinApi_Native_WinUser_MB_ICON_MB_ICONEXCLAMATION">MB_ICONEXCLAMATION</a></td><td>See <a class="xref" href="THNETII.WinApi.Native.WinUser.MB_ICON.html#THNETII_WinApi_Native_WinUser_MB_ICON_MB_ICONWARNING">MB_ICONWARNING</a>.</td></tr><tr><td><a class="xref" href="THNETII.WinApi.Native.WinUser.MB_ICON.html#THNETII_WinApi_Native_WinUser_MB_ICON_MB_ICONERROR">MB_ICONERROR</a></td><td>The sound specified as the Windows Critical Stop sound. </td></tr><tr><td><a class="xref" href="THNETII.WinApi.Native.WinUser.MB_ICON.html#THNETII_WinApi_Native_WinUser_MB_ICON_MB_ICONHAND">MB_ICONHAND</a></td><td>See <a class="xref" href="THNETII.WinApi.Native.WinUser.MB_ICON.html#THNETII_WinApi_Native_WinUser_MB_ICON_MB_ICONERROR">MB_ICONERROR</a>. </td></tr><tr><td><a class="xref" href="THNETII.WinApi.Native.WinUser.MB_ICON.html#THNETII_WinApi_Native_WinUser_MB_ICON_MB_ICONINFORMATION">MB_ICONINFORMATION</a></td><td>The sound specified as the Windows Asterisk sound. </td></tr><tr><td><a class="xref" href="THNETII.WinApi.Native.WinUser.MB_ICON.html#THNETII_WinApi_Native_WinUser_MB_ICON_MB_ICONQUESTION">MB_ICONQUESTION</a></td><td>The sound specified as the Windows Question sound. </td></tr><tr><td><a class="xref" href="THNETII.WinApi.Native.WinUser.MB_ICON.html#THNETII_WinApi_Native_WinUser_MB_ICON_MB_ICONSTOP">MB_ICONSTOP</a></td><td>See <a class="xref" href="THNETII.WinApi.Native.WinUser.MB_ICON.html#THNETII_WinApi_Native_WinUser_MB_ICON_MB_ICONERROR">MB_ICONERROR</a>. </td></tr><tr><td><a class="xref" href="THNETII.WinApi.Native.WinUser.MB_ICON.html#THNETII_WinApi_Native_WinUser_MB_ICON_MB_ICONWARNING">MB_ICONWARNING</a></td><td>The sound specified as the Windows Exclamation sound. </td></tr><tr><td><code>(<a class="xref" href="THNETII.WinApi.Native.WinUser.MB_ICON.html">MB_ICON</a>)0</code></td><td>The sound specified as the Windows Default Beep sound. </td></tr></tbody></table>
</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.boolean">Boolean</a></td>
        <td><p>If the function succeeds, the return value is <code>true</code>.</p>
<p>If the function fails, the return value is <code>false</code>. To get extended error information, call <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.runtime.interopservices.marshal.getlastwin32error#System_Runtime_InteropServices_Marshal_GetLastWin32Error">GetLastWin32Error()</a>.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_MessageBeep_THNETII_WinApi_Native_WinUser_MB_ICON__remarks">Remarks</h5>
  <div class="markdown level1 remarks"><p>After queuing the sound, the <a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_MessageBeep_THNETII_WinApi_Native_WinUser_MB_ICON_">MessageBeep(MB_ICON)</a> function returns control to the calling function and plays the sound asynchronously.</p>
<p>If it cannot play the specified alert sound, <a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_MessageBeep_THNETII_WinApi_Native_WinUser_MB_ICON_">MessageBeep(MB_ICON)</a> attempts to play the system default sound. If it cannot play the system default sound, the function produces a standard beep sound through the computer speaker.</p>
<p>The user can disable the warning beep by using the Sound control panel application.</p>
<p><strong>Note:</strong> To send a beep to a remote client, use the <a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_Beep_System_Int32_System_Int32_">Beep(Int32, Int32)</a> function. The <a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_Beep_System_Int32_System_Int32_">Beep(Int32, Int32)</a> function is redirected to the client, whereas <a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_MessageBeep_THNETII_WinApi_Native_WinUser_MB_ICON_">MessageBeep(MB_ICON)</a> is not.</p>
<p>
<table><thead><tr><th>Requirements</th><th></th></tr></thead><tbody><tr><td><strong>Minimum supported client:</strong></td><td>Windows XP [desktop apps only]</td></tr><tr><td><strong>Minimum supported server:</strong></td><td>Windows Server 2003 [desktop apps only]</td></tr></tbody></table>
</p>
<p>Microsoft Docs page: <a href="https://docs.microsoft.com/en-us/windows/desktop/api/WinUser/nf-winuser-messagebeep">MessageBeep function</a></p>
</div>
  <h5 class="exceptions">Exceptions</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Condition</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.dllnotfoundexception">DllNotFoundException</a></td>
        <td><p>The native library containg the function could not be found.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.entrypointnotfoundexception">EntryPointNotFoundException</a></td>
        <td><p>Unable to find the entry point for the function in the native library.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_MessageBeep_THNETII_WinApi_Native_WinUser_MB_ICON__seealso">See Also</h5>
  <div class="seealso">
      <div><a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_Beep_System_Int32_System_Int32_">Beep(Int32, Int32)</a></div>
      <div><a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_FlashWindow_System_IntPtr_System_Boolean_">FlashWindow(IntPtr, Boolean)</a></div>
  </div>
  
  
  <a id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_RtlCaptureStackBackTrace_" data-uid="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.RtlCaptureStackBackTrace*"></a>
  <h4 id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_RtlCaptureStackBackTrace_System_Int32_System_Int32_THNETII_InteropServices_NativeMemory_Specialized_ArrayOfIntPtr__System_Int32__" data-uid="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.RtlCaptureStackBackTrace(System.Int32,System.Int32,THNETII.InteropServices.NativeMemory.Specialized.ArrayOfIntPtr@,System.Int32@)">RtlCaptureStackBackTrace(Int32, Int32, out ArrayOfIntPtr, out Int32)</h4>
  <div class="markdown level1 summary"><p>Captures a stack back trace by walking up the stack and recording the information for each frame.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static ushort RtlCaptureStackBackTrace(int FramesToSkip, int FramesToCapture, out ArrayOfIntPtr BackTrace, out int BackTraceHash)</code></pre>
  </div>
  <h5 class="parameters">Parameters</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.int32">Int32</a></td>
        <td><span class="parametername">FramesToSkip</span></td>
        <td><p>The number of frames to skip from the start of the back trace.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.int32">Int32</a></td>
        <td><span class="parametername">FramesToCapture</span></td>
        <td><p>The number of frames to be captured. You can capture up to the <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.uint16.maxvalue">MaxValue</a> of the <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.uint16">UInt16</a> type frames.</p>
<p><strong>Windows Server 2003 and Windows XP:</strong> The sum of the <code data-dev-comment-type="paramref" class="paramref">FramesToSkip</code> and <code data-dev-comment-type="paramref" class="paramref">FramesToCapture</code> parameters must be less than <code>63</code>.</p>
</td>
      </tr>
      <tr>
        <td><span class="xref">THNETII.InteropServices.NativeMemory.Specialized.ArrayOfIntPtr</span></td>
        <td><span class="parametername">BackTrace</span></td>
        <td><p>Receives a pointer to an array of stack frame pointers from the current stack trace.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.int32">Int32</a></td>
        <td><span class="parametername">BackTraceHash</span></td>
        <td><p>A value that can be used to organize hash tables. The value is optional and can be ignored or discarded.</p>
<p>This value is calculated based on the values of the pointers returned in the <code data-dev-comment-type="paramref" class="paramref">BackTrace</code> array. Two identical stack traces will generate identical hash values.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.uint16">UInt16</a></td>
        <td><p>The number of captured frames.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_RtlCaptureStackBackTrace_System_Int32_System_Int32_THNETII_InteropServices_NativeMemory_Specialized_ArrayOfIntPtr__System_Int32___remarks">Remarks</h5>
  <div class="markdown level1 remarks"><p>
<table><thead><tr><th>Requirements</th><th></th></tr></thead><tbody><tr><td><strong>Minimum supported client:</strong></td><td>Windows Vista [desktop apps | UWP apps]</td></tr><tr><td><strong>Minimum supported server:</strong></td><td>Windows Server 2008 [desktop apps | UWP apps]</td></tr></tbody></table>
</p>
<p>Microsoft Docs page: <a href="https://msdn.microsoft.com/en-us/library/Bb204633.aspx">CaptureStackBackTrace function</a></p>
</div>
  <h5 class="exceptions">Exceptions</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Condition</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.dllnotfoundexception">DllNotFoundException</a></td>
        <td><p>The native library containg the function could not be found.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.entrypointnotfoundexception">EntryPointNotFoundException</a></td>
        <td><p>Unable to find the entry point for the function in the native library.</p>
</td>
      </tr>
    </tbody>
  </table>
  
  
  <a id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_SetErrorMode_" data-uid="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.SetErrorMode*"></a>
  <h4 id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_SetErrorMode_THNETII_WinApi_Native_WinBase_SYSTEM_ERROR_MODE_" data-uid="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.SetErrorMode(THNETII.WinApi.Native.WinBase.SYSTEM_ERROR_MODE)">SetErrorMode(SYSTEM_ERROR_MODE)</h4>
  <div class="markdown level1 summary"><p>Controls whether the system will handle the specified types of serious errors or whether the process will handle them.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static SYSTEM_ERROR_MODE SetErrorMode(SYSTEM_ERROR_MODE uMode)</code></pre>
  </div>
  <h5 class="parameters">Parameters</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="THNETII.WinApi.Native.WinBase.SYSTEM_ERROR_MODE.html">SYSTEM_ERROR_MODE</a></td>
        <td><span class="parametername">uMode</span></td>
        <td><p>The process error mode. This parameter can be one or more of the following values.</p>
<table><thead><tr><th>Value</th><th>Meaning</th></tr></thead><tbody><tr><td><code>0</code> (zero)<br><code>default(<a class="xref" href="THNETII.WinApi.Native.WinBase.SYSTEM_ERROR_MODE.html">SYSTEM_ERROR_MODE</a>)</code></td><td>Use the system default, which is to display all error dialog boxes.</td></tr><tr><td><a class="xref" href="THNETII.WinApi.Native.WinBase.SYSTEM_ERROR_MODE.html#THNETII_WinApi_Native_WinBase_SYSTEM_ERROR_MODE_SEM_FAILCRITICALERRORS">SEM_FAILCRITICALERRORS</a></td><td><p>The system does not display the critical-error-handler message box. Instead, the system sends the error to the calling process.</p>Best practice is that all applications call the process-wide <a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_SetErrorMode_THNETII_WinApi_Native_WinBase_SYSTEM_ERROR_MODE_">SetErrorMode(SYSTEM_ERROR_MODE)</a> function with a parameter of <a class="xref" href="THNETII.WinApi.Native.WinBase.SYSTEM_ERROR_MODE.html#THNETII_WinApi_Native_WinBase_SYSTEM_ERROR_MODE_SEM_FAILCRITICALERRORS">SEM_FAILCRITICALERRORS</a> at startup. This is to prevent error mode dialogs from hanging the application.<p></td></tr><tr><td><a class="xref" href="THNETII.WinApi.Native.WinBase.SYSTEM_ERROR_MODE.html#THNETII_WinApi_Native_WinBase_SYSTEM_ERROR_MODE_SEM_NOALIGNMENTFAULTEXCEPT">SEM_NOALIGNMENTFAULTEXCEPT</a></td><td><p>The system automatically fixes memory alignment faults and makes them invisible to the application. It does this for the calling process and any descendant processes. This feature is only supported by certain processor architectures. For more information, see the Remarks section. </p>After this value is set for a process, subsequent attempts to clear the value are ignored.<p></td></tr><tr><td><a class="xref" href="THNETII.WinApi.Native.WinBase.SYSTEM_ERROR_MODE.html#THNETII_WinApi_Native_WinBase_SYSTEM_ERROR_MODE_SEM_NOGPFAULTERRORBOX">SEM_NOGPFAULTERRORBOX</a></td><td>The system does not display the Windows Error Reporting dialog.</td></tr><tr><td><a class="xref" href="THNETII.WinApi.Native.WinBase.SYSTEM_ERROR_MODE.html#THNETII_WinApi_Native_WinBase_SYSTEM_ERROR_MODE_SEM_NOOPENFILEERRORBOX">SEM_NOOPENFILEERRORBOX</a></td><td>The <see cref="!:OpenFile"></see> function does not display a message box when it fails to find a file. Instead, the error is returned to the caller. This error mode overrides the <see cref="!:OF_PROMPT"></see> flag.</td></tr></tbody></table>
</td>
      </tr>
    </tbody>
  </table>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="THNETII.WinApi.Native.WinBase.SYSTEM_ERROR_MODE.html">SYSTEM_ERROR_MODE</a></td>
        <td><p>The return value is the previous state of the error-mode bit flags.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_SetErrorMode_THNETII_WinApi_Native_WinBase_SYSTEM_ERROR_MODE__remarks">Remarks</h5>
  <div class="markdown level1 remarks"><p>Each process has an associated error mode that indicates to the system how the application is going to respond to serious errors. A child process inherits the error mode of its parent process. To retrieve the process error mode, use the <a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_GetErrorMode">GetErrorMode()</a> function.</p>
<p>Because the error mode is set for the entire process, you must ensure that multi-threaded applications do not set different error-mode flags. Doing so can lead to inconsistent error handling.</p>
<p>The system does not make alignment faults visible to an application on all processor architectures. Therefore, specifying <a class="xref" href="THNETII.WinApi.Native.WinBase.SYSTEM_ERROR_MODE.html#THNETII_WinApi_Native_WinBase_SYSTEM_ERROR_MODE_SEM_NOALIGNMENTFAULTEXCEPT">SEM_NOALIGNMENTFAULTEXCEPT</a> is not an error on such architectures, but the system is free to silently ignore the request.</p>
<p><strong>Windows 7:</strong><br>Callers should favor <see cref="!:SetThreadErrorMode"></see> over <a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_SetErrorMode_THNETII_WinApi_Native_WinBase_SYSTEM_ERROR_MODE_">SetErrorMode(SYSTEM_ERROR_MODE)</a> since it is less disruptive to the normal behavior of the system. </p>
<p>
<table><thead><tr><th>Requirements</th><th></th></tr></thead><tbody><tr><td><strong>Minimum supported client:</strong></td><td>Windows XP [desktop apps | UWP apps]</td></tr><tr><td><strong>Minimum supported server:</strong></td><td>Windows Server 2003 [desktop apps | UWP apps]</td></tr></tbody></table>
</p>
<p>Microsoft Docs page: <a href="https://msdn.microsoft.com/en-us/library/ms680621.aspx">SetErrorMode function</a></p>
</div>
  <h5 class="exceptions">Exceptions</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Condition</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.dllnotfoundexception">DllNotFoundException</a></td>
        <td><p>The native library containg the function could not be found.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.entrypointnotfoundexception">EntryPointNotFoundException</a></td>
        <td><p>Unable to find the entry point for the function in the native library.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 id="THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_SetErrorMode_THNETII_WinApi_Native_WinBase_SYSTEM_ERROR_MODE__seealso">See Also</h5>
  <div class="seealso">
      <div><a class="xref" href="THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions.html#THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions_GetErrorMode">GetErrorMode()</a></div>
  </div>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/thnetii/windows-api/new/master/apiSpec/new?filename=THNETII_WinApi_Native_ErrorHandling_ErrorHandlingFunctions.md&amp;value=---%0Auid%3A%20THNETII.WinApi.Native.ErrorHandling.ErrorHandlingFunctions%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A" class="contribution-link">Improve this Doc</a>
                  </li>
                  <li>
                    <a href="https://github.com/thnetii/windows-api/blob/master/src/THNETII.WinApi.Functions.ErrorHandling/ErrorHandlingFunctions.cs/#L25" class="contribution-link">View Source</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
